# Lecture 9ï¼šExplainable MLï¼ˆMachine Learningï¼‰

> Lectured by HUNG-YI LEE (æå®æ¯…)
>
> Recorded by Yusheng zhaoï¼ˆyszhao0717@gmail.comï¼‰

***

\[TOC]

***

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®­ç»ƒäº†å¾ˆå¤šç±»å‹çš„æ¨¡å‹ã€‚æˆ‘ä»¬æœ‰åšåˆ°å›¾åƒåˆ†ç±»ä»»åŠ¡çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œè¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œå®ƒç»™æˆ‘ä»¬ç­”æ¡ˆï¼Œä¸å•å•æ»¡è¶³äºæ­¤ï¼Œæˆ‘ä»¬è¿˜æƒ³äº†è§£åˆ°å®ƒå¾—åˆ°ç­”æ¡ˆçš„ç†ç”±ã€‚

## Why we need Explainable MLï¼Ÿ

*   å°±ç®—æœºå™¨æ€»æ˜¯èƒ½å¾—åˆ°æ­£ç¡®çš„ç­”æ¡ˆï¼Œå´ä¸ä¸€å®šè¡¨ç¤ºæœºå™¨æ˜¯â€œæ™ºèƒ½â€çš„ã€‚

    > ç¥é©¬æ±‰æ–¯çš„ä¾‹å­
* ç°åœ¨çš„äººå·¥æ™ºèƒ½çš„åº”ç”¨ä¸­ï¼Œå¯è§£é‡Šæ€§çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¾€å¾€æ˜¯å¿…é¡»çš„ã€‚
  * é“¶è¡Œç”¨æœºå™¨æ¨¡å‹æ¥åˆ¤æ–­æ˜¯å¦å…è®¸æ”¾è´·ï¼Œè¿™éœ€è¦æœºå™¨ç»™å‡ºåˆ¤æ–­ä»¥åŠç»™å‡ºæŠ˜æœçš„ç†ç”±
  * ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹æ¥ç»™å‡ºåŒ»ç–—è¯Šæ–­
  * æœºå™¨å­¦ä¹ ç”¨åœ¨æ³•å¾‹ä¸Šï¼šå¸®åŠ©æ³•å®˜åˆ¤æ¡ˆã€ç¡®ä¿æœºå™¨çš„å…¬æ­£æ€§ï¼Œä¸ä»…éœ€è¦ç­”æ¡ˆè¿˜éœ€è¦ç»™å‡ºç­”æ¡ˆçš„ç†ç”±
  * æ— äººé©¾é©¶ï¼šé“è·¯è¡Œä¸ºä¾‹å¦‚æ€¥åˆ¹ã€åŠ é€Ÿï¼ˆå†³ç­–èƒŒåçš„åŸå› éœ€è¦åˆæƒ…åˆç†ï¼‰
* æˆ‘ä»¬å¯ä»¥åŸºäºå¯è§£é‡Šæ€§çš„æ¡†æ¶æ¥ä¸æ–­æ”¹è¿›æœºå™¨å­¦ä¹ æ¨¡å‹
  * æ— å˜å¤´çš„æœºå™¨å­¦ä¹ ï¼šç»™ä½ çš„é»‘ç®±æ¨¡å‹æ‰”ä¸€å †æ•°æ®ï¼Œç»è¿‡å„ç§è®¡ç®—ï¼Œè·‘å‡ºä¸ªç»“æœï¼›ç»“æœä¸ç†æƒ³æ€ä¹ˆåŠï¼Ÿçˆ†è°ƒå‚æ•°ï¼šlrï¼Œæ”¹æ”¹networkæ¶æ„ã€‚â€”â€”é…±ç´«å¤ªä¸ä¸¥è°¨äº†å­/(ã„’oã„’)/\~\~
  * ä½†æ˜¯å¦‚æœæˆ‘ä»¬çŸ¥é“ä¸ç†æƒ³çš„æ¨¡å‹ç»“æœï¼ŒçŸ¥é“å…¶å‘ç”Ÿåœ¨æ¨¡å‹ä¸­çš„å…·ä½“è¦ç´ ã€‚åšåˆ°å¯è§£é‡Šæ€§æ˜¯éå¸¸å¿…è¦çš„ã€‚

## interpretable v.s. powerful

ä»¥Linear modelä¸ºä¾‹ï¼šinterpretableå¾€å¾€è¦æ±‚æ¨¡å‹éå¸¸ç®€å•ï¼Œè¿™å¯¼è‡´ç›¸å¯¹çš„not powerfulã€‚

ä»¥Deep networkä¸ºä¾‹ï¼šblack boxesâ€¦éš¾ä»¥è§£é‡Šï¼Œä½†è¿œæ¯”Linear modelæ›´åŠ powerful

*   ä¸åº”è¯¥å› ä¸ºä¸€ä¸ªæ¨¡å‹difficult to interpretableå°±æ‰¬å¼ƒå®ƒï¼Œè€Œåº”å½“å†åˆ©ç”¨powerfulçš„æ€§èƒ½çš„åŒæ—¶å»è¯•å›¾è¿½åŠ å¯è§£é‡Šæ€§ã€‚

    > ä¸€ä½é†‰æ±‰åœ¨è·¯ç¯ä¸‹é¢æ‰¾é’¥åŒ™çš„æ•…äº‹

å› æ­¤æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦æ‰¾åˆ°**å¼ºå¤§å¹¶ä¸”ç®€å•åˆ°å…·å¤‡å¯è§£é‡Šæ€§çš„æ¨¡å‹**

*   ç›®æ ‡æ¨¡å‹1ï¼šå†³ç­–æ ‘ï¼ˆdecision treeï¼‰

    > decision tree is all you needï¼Ÿ :ï¼‰

    * A tree can still be terrible
    * Kaggleä¸­å¸¸ç”¨çš„æ•ˆæœå¥½çš„æŠ€æœ¯ï¼Œä¸æ­¢ä¸€æ£µçš„decision treeï¼ˆRandom Forestï¼‰ï¼Œå®é™…æ˜¯è‹¥å¹²æ£µï¼ˆe.g.500æ£µï¼‰å†³ç­–æ ‘ï¼ˆæ£®æ—ï¼‰ä¸€èµ·èµ·ä½œç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹äºå†³ç­–ä½œç”¨çš„è§£é‡Šå°±æ¯”è¾ƒéš¾è¯´æ˜äº†ã€‚
    * ç”±æ­¤ï¼Œå†³ç­–æ ‘å¹¶ä¸èƒ½æ»¡è¶³å¯è§£é‡Šæ€§çš„æœºå™¨å­¦ä¹ æ¨¡å‹è¿™ä¸ªé—®é¢˜ã€‚

## Goal of Explainable ML

> ä¹‹å‰å‡ è®²çš„ä½œä¸šâ€”â€”æ˜ç¡®çš„ç›®æ ‡ï¼šé™ä½error rateæˆ–æ˜¯æå‡accuracy

ç„¶è€Œï¼ŒExplainable MLçš„ç›®æ ‡æ˜¯ä¸æ˜ç¡®çš„ã€‚ï¼ˆä½œä¸šä¹Ÿæ²¡æœ‰leaderboardï¼‰å…³äºExplainable MLçš„ç›®æ ‡ä»¥ä¸‹æ˜¯è€å¸ˆçš„å‡ ç‚¹çœ‹æ³•ï¼š

* Completely know how an ML model works?ï¼ˆæ•´ä¸ªæ¨¡å‹åœ¨åšä»€ä¹ˆäº‹ï¼Œå®Œå…¨äº†è§£æ¨¡å‹å¦‚ä½•åšä¸€ä¸ªå†³ç­–ï¼‰
* æˆ‘ä»¬çœŸçš„éœ€è¦Completely know how an ML model works? äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿä¸å®Œå…¨äº†è§£äººè„‘æ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å®Œå…¨ç›¸ä¿¡äººæ‰€åšå‡ºçš„å†³ç­–ã€‚
*   ä¸€ä¸ªæœ‰è¶£çš„å¿ƒç†å®éªŒ

    ![image-20220324230948353](https://s1.328888.xyz/2022/05/04/htzB7.png)

    *   å¥½çš„Explanationï¼šäººèƒ½æ¥å—çš„Explanation

        ç„å­¦çš„å¿ƒç†è¦ç´ ï¼šç»™ä¸€ä¸ªâ€ç†ç”±â€œï¼Œè®©äººï¼ˆç”¨æˆ·ã€reviewersã€è‡ªèº«ï¼‰comfortableï¼Œè®©äººé«˜å…´ã€‚

## Explainable ML

\==åˆ†æˆä¸¤å¤§ç±»ï¼š_**Local Explanation**_ã€_**Global Explanation**_==

### _**Local Explanation**_

å¯¹ç‰¹å®šçš„æŸä¸ªæ•°æ®è¦æ±‚æœºå™¨ï¼ˆæ¨¡å‹ï¼‰åšä¸€ä¸ªé’ˆå¯¹ç»“æœçš„è§£é‡Š

> Why do you think $\underline{this \ image}$ is a cat?

#### Which component is criticalï¼Ÿ

![image-20220324233322759](https://s1.328888.xyz/2022/05/04/htp8X.png)

å¦‚ä¸Šå›¾ï¼Œç»™æœºå™¨ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œå›¾ç‰‡é‡Œçš„ä»€ä¹ˆä¸œè¥¿ï¼ˆeyeï¼Ÿearï¼Ÿï¼‰è®©æœºå™¨è§‰å¾—è¿™æ˜¯ä¸€åªçŒ«ï¼ˆåšå‡ºåˆ¤æ–­ï¼‰

å¯¹äº$Object \ x$ï¼Œæ¨å¹¿æ¥è¯´å¯ä»¥æ˜¯å½±åƒã€æ–‡æœ¬ç­‰ï¼Œè¿™ä¸ª$x$å¯ä»¥æ‹†æˆè‹¥å¹²ä¸ªcomponent$x = {x\_1,x\_2,...,x\_n,...,x\_N}$ï¼Œå¯¹åº”æ¥è¯´è¿™é‡Œæ¯ä¸€ä¸ªcomponentå°±æ˜¯ä¸€ä¸ªpixelæˆ–è€…segmentæˆ–è€…a wordï¼ˆtokenï¼‰ç­‰â€”â€”è¿™äº›compomentä¸­å“ªäº›/å“ªä¸€ä¸ªå¯¹äºæœºå™¨åšå‡ºåˆ¤æ–­èµ·åˆ°å†³å®šæ€§ä½œç”¨ï¼Ÿ

> ï¼ˆæœ€ç®€å•çš„ä¸€ç§æ–¹å¼ï¼‰ç±»ä¼¼äºå¯¹ç…§å®éªŒï¼šæŠŠæ¯ä¸€ä¸ªcomponentå•ç‹¬æ‹¿å‡ºæ¥ï¼Œåšä¸€ä¸ªæ”¹é€ /åˆ é™¤ï¼Œä¹‹åå¦‚æœnetworkçš„è¾“å‡ºå‘ç”Ÿå·¨å¤§çš„å˜åŒ–ï¼Œé‚£ä¹ˆè¡¨é¢è¿™ä¸ªcomponentå¿…ä¸å¯å°‘ã€‚

E.g. ç”¨maskç›–ä½å›¾åƒæ¥æµ‹è¯•ç½‘ç»œçš„è¾“å‡ºï¼ˆæ§åˆ¶å˜é‡äº†å±äºæ˜¯ï¼‰

![image-20220408085557666](https://s1.328888.xyz/2022/05/04/htY1t.png)

è¿™ä¸ªå®éªŒæä¾›äº†ç½‘ç»œä¸­å¯¹äºç›®æ ‡çš„ä½ç½®ä¿¡æ¯ã€‚

> é‡åŒ–componenté‡è¦æ€§ï¼šè¿›é˜¶çš„ä¸€ç§æ–¹å¼ï¼ˆè®¡ç®—æ¢¯åº¦ï¼‰ã€‚
>
> æœ‰ä¸€å¼ å›¾ç‰‡å°†å…¶å†™åš${x\_1,...,x\_n,...,x\_N}$ï¼Œæ¯ä¸ª$x\_i$ä»£è¡¨ä¸€ä¸ªpixelã€‚
>
> * ç„¶åæˆ‘ä»¬æ¥è®¡ç®—è¿™ä¸ªä¾‹å­çš„lossï¼Œè®°ä½œ$e$ï¼Œè¿™ä¸ªlosså€¼æ˜¯ground truthå’Œç½‘ç»œ/æ¨¡å‹è¾“å‡ºçš„ç›¸å¼‚æ€§çš„åº¦é‡ï¼ˆä¸€èˆ¬æ˜¯cross entropyï¼‰ã€‚eè¶Šå¤§è¡¨ç¤ºè¾©è¯†ç»“æœè¶Šå·®ã€‚
> *   å¯¹äºæŸä¸€ä¸ªpixelï¼Œå°†å…¶componentåŠ ä¸€ä¸ªå°å°çš„å¢é‡${x\_1,...,x\_n + \Delta x,...,x\_N}$ï¼Œè®¡ç®—æ‰€å¾—çš„$e' = e + \Delta e$ï¼Œå¦‚æœè¿™ä¸ª$\Delta e $å¾ˆå¤§ï¼Œè¡¨æ˜è¿™ä¸ªcomponentå¯¹ç½‘ç»œè¾“å‡ºæœ‰ç€è¾ƒå¤§çš„å½±å“ã€‚å¦‚æœ$e'$è¶‹è¿‘äº$e$ï¼Œé‚£ä¹ˆè¿™ä¸ªpixelå°±æ¯”è¾ƒæ— å…³ç´§è¦ã€‚æˆ‘ä»¬é€šå¸¸ç”¨
>
>     $$
>     |\frac{\Delta e}{\Delta x}| \rightarrow |\frac{\part e}{\part x_n}|
>     $$
>
>     æ¥è¡¨ç¤ºç›¸å¯¹åº”componentçš„é‡è¦æ€§ï¼ˆå¥½åƒçµæ•åº¦åˆ†æï¼‰ï¼Œä»¥ä¸Šå…¬å¼è¡¨æ˜è¯¥æµ‹é‡å…¶å®å°±æ˜¯$x\_N$å¯¹lossåšåå¾®åˆ†ã€‚
> *   æŠŠè¿™å¼ å›¾ç‰‡ä¸­æ¯ä¸€ä¸ªpixelçš„è¿™ä¸ªé‡è¦æ€§éƒ½ç®—å‡ºæ¥ï¼Œç»„æˆæ–°çš„å›¾ç§°ä¹‹ä¸º**Saliency Map**
>
>     ![image-20220408091457182](https://s1.328888.xyz/2022/05/04/htRz1.png)
>
>     å›¾ä¸Šè¶Šåç™½è‰²ï¼Œè¡¨æ˜å€¼è¶Šå¤§ï¼Œè¿™ä¸ªpixelè¶Šé‡è¦ã€‚
>
>     Karen Simonyan, Andrea Vedaldi, Andrew Zisserman, â€œDeep Inside Convolutional Networks: Visualising Image Classification Models and Saliency Mapsâ€, ICLR, 2014
> * å®è·µï¼šè®­ç»ƒä¸€ä¸ªåˆ†ç±»å®å¯æ¢¦å’Œæ•°ç å®è´çš„åˆ†ç±»å™¨
>   * èµ„æ–™ï¼š
>     * PokÃ©mon images:https://www.Kaggle.com/kvpratama/pokemon-images-dataset/data
>     * Digimon images:https://github.com/DeathReaper0965/Digimon-Generator-GAN
>   * å®éªŒç»“æœï¼Œæ³›åŒ–Accuracyååˆ†amazingï¼
>   * ç”»Saliency Map
>     * èµ„æ–™å·®å¼‚ã€‚ç”»çš„mapå‘ç°æœºå™¨åªå…³æ³¨éæœ¬ä½“éƒ¨åˆ†ï¼ˆèƒŒæ™¯ï¼‰ï¼Œå®é™…ä¸Šå› ä¸ºæ–‡ä»¶æ ¼å¼å·®å¼‚ï¼Œå®å¯æ¢¦å’Œæ•°ç å®è´èµ„æ–™å›¾åƒèƒŒæ™¯é¢œè‰²ä¸åŒï¼ˆé€æ˜å³é»‘ã€‚æœºå™¨åªæ ¹æ®è¿™ä¸ªæ¥å®ç°äºŒåˆ†ç±»ã€‚
> *   æ›´å¤šçš„å®è·µï¼š
>
>     ![image-20220408094122196](https://s1.328888.xyz/2022/05/04/htILg.png)
>
>     æ•°æ®é›†çš„å·¨å¤§å½±å“ï¼šæœºå™¨çš„å…³æ³¨ç‚¹ã€‚åˆ¤æ–­â€œé©¬â€çš„è®­ç»ƒèµ„æ–™é€šå¸¸æœ‰ç›¸åŒçš„æ°´å°ï¼Œæ°´å°éƒ¨åˆ†ä¾¿æˆä¸ºåˆ¤æ–­æ˜¯å¦é©¬çš„é‡è¦çš„componentã€‚

ğŸ‘†çš„å¯ç¤ºï¼šExplainable Machine Learningæ˜¯éå¸¸é‡è¦çš„ã€‚

#### Limitationï¼šNoisy Gradient

æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½æŠŠSaliency Mapç”»å¾—æ›´å¥½å‘¢ï¼Ÿ

* æ–¹æ³•ä¸€ï¼šSmoothGrad

![](https://s1.328888.xyz/2022/05/04/htcue.png)

æµç¨‹ï¼šåœ¨å›¾ç‰‡ä¸Šé¢åŠ ä¸Šä¸åŒçš„å™ªå£°ï¼Œå¾—åˆ°è‹¥å¹²å¼ ä¸åŒåŠ ä¸Šå™ªå£°çš„å›¾ç‰‡ï¼Œä»è€Œè·å¾—æ•°å¼ Saliency Mapï¼Œå¹³å‡èµ·æ¥å°±å¾—åˆ°SmoothGradçš„ç»“æœã€‚

**å…‰çœ‹æ¢¯åº¦ï¼ˆGradientï¼‰å¹¶ä¸èƒ½åæ˜ componentçš„é‡è¦æ€§**æˆ–è€…è¯´**æ¢¯åº¦ï¼ˆGradientï¼‰å¹¶ä¸èƒ½æ€»æ˜¯åæ˜ componentçš„é‡è¦æ€§**

> E.g. ![image-20220408105854342](https://s1.328888.xyz/2022/05/04/htw3q.png)
>
> é¼»å­è¶Šé•¿ï¼Œå¤§è±¡çš„å¯èƒ½æ€§è¶‹è¿‘ä¸å˜ï¼Œè¿™æ˜¯å¾—åˆ°çš„åå¾®åˆ†è¶‹è¿‘äº0ï¼Œéš¾é“è¿™å°±è¯´æ˜äº†é¼»å­é•¿åº¦çš„å˜åŒ–ä¸æ˜¯å¦å¤§è±¡å¯èƒ½æ€§çš„å˜åŒ–æ— å…³ï¼Ÿæ˜¾ç„¶æ˜¯é”™è¯¯çš„ã€‚
>
> æ‰€ä»¥å…‰çœ‹åå¾®åˆ†çš„ç»“æœæ²¡æ³•å®Œå…¨åæ˜ componentçš„é‡è¦æ€§

\==æ”¹å–„çš„æ–¹æ³•ï¼šIntegrated Gradientï¼ˆIGï¼‰==ï¼šhttps://arxiv.org/abs/1611.02639

#### How a network processes the input dataï¼Ÿâ€”â€”networkæ˜¯æ€ä¹ˆå¤„ç†è¿™ä¸ªè¾“å…¥çš„å‘¢

*   æœ€ç›´è§‰çš„ï¼š**å¯è§†åŒ–ï¼ˆVisualizationï¼‰**

    > ä½œä¸šBERTä»¥åŠè¯­éŸ³è¯†åˆ«ï¼Œ
    >
    > * ä»¥ä¸€ä¸ªlayerçš„100ä¸ªç¥ç»å…ƒä¸ºä¾‹ï¼šPCA or t-SNEè®©100ç»´å‘é‡é™åˆ°2ç»´ï¼›plot on figure
    >
    > ![image-20220408121512397](https://s1.328888.xyz/2022/05/04/ht3BP.png)
    >
    > æ¥è‡ªA. Mohamed, G. Hinton, and G. Penn, â€œUnderstanding how Deep Belief Networks Perform Acoustic Modelling,â€ in ICASSP, 2012.
    >
    > *   åˆ†æattentionçš„layer
    >
    >     ![image-20220408121642361](https://s1.328888.xyz/2022/05/04/htO8m.png)
    >
    >     ä¸€äº›æ–‡çŒ®ï¼š[Attention is not Explanation](https://arxiv.org/abs/1902.10186)ã€[Attention is not not Explanation](https://arxiv.org/abs/1908.04626)
    >
    >     _"attentionèƒ½ä¸èƒ½è¢«è§£é‡Š"ä¾ç„¶æ˜¯å°šå¾…ç ”ç©¶çš„é—®é¢˜_ï¼ˆç¦æ­¢å¥—å¨ƒè›¤ï¼‰
*   å¦å¤–ä¸€ç§æŠ€æœ¯ï¼š**æ¢é’ˆï¼ˆProbingï¼‰**

    ç”¨æ¢é’ˆæ’å…¥networkçœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œæƒ³äº†è§£BERTçš„layeré‡Œé¢åˆ°åº•å­¦åˆ°äº†ä»€ä¹ˆä¸œè¥¿ï¼Œå®é™…ä¸Šå¯è§†åŒ–æŠ€å·§å°±æ¯”è¾ƒå±€é™äº†ã€‚

    æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨**æ¢é’ˆ**â€”â€”å®è´¨ä¸Šæ˜¯è®­ç»ƒå¥½çš„ä¸€ä¸ªåˆ†ç±»å™¨ï¼šï¼ˆE.g.ï¼‰

    * æ¢é’ˆ1ï¼šPOS Classifierâ€”â€”æ ¹æ®ä¸€ä¸ªfeatureå³è¾“å…¥çš„å‘é‡ï¼ˆEmbeddingï¼‰åˆ¤æ–­å…¶POS tagï¼Œä¹Ÿå°±æ˜¯æ¥è‡ªäºå“ªä¸€ä¸ªè¯æ€§çš„è¯æ±‡ã€‚å¦‚æœæ­£ç¡®ç‡é«˜ï¼Œåˆ™è¡¨æ˜å…¶æœ‰ä¸°å¯Œçš„è¯æ€§çš„èµ„è®¯ï¼›å¦‚æœæ­£ç¡®ç‡ä½ï¼Œåˆ™è¡¨æ˜è¿™äº›embeddingæ²¡æœ‰è¯æ€§çš„èµ„è®¯ã€‚
    * æ¢é’ˆ2ï¼šNER Classifierï¼ˆå‘½åå®ä½“è¯†åˆ«Named Entity Recognitionï¼Œç®€ç§°NERï¼‰ï¼Œä»–æ ¹æ®è¿™äº›è¾“å…¥çš„featureï¼Œåˆ¤æ–­å“ªäº›è¯æ±‡æ˜¯å±äºäººåè¿˜æ˜¯åœ°åï¼Œè¿˜æ˜¯è¯´å…¶ä»–ä¸“æœ‰åè¯ã€‚
    * Tipsï¼šå°å¿ƒä½¿ç”¨çš„classifierçš„å¼ºåº¦ï¼Œå¦‚æœè¿™ä¸ªclassiferå¤ªçƒ‚äº†ï¼ˆæ²¡trainå¥½ï¼‰ï¼Œå°±ä¼šå½±å“å…³äºembeddingèµ„è®¯çš„åˆ¤æ–­â€¦

    å…³äºprobingçš„ä¾‹å­ï¼šè®­ç»ƒä¸€ä¸ªè¯­éŸ³åˆæˆçš„æ¨¡å‹ï¼ˆè®­ç»ƒè¿™æ ·ä¸€ä¸ªTTSã€Text to Speechã€‘æ¨¡å‹ï¼ŒæŠŠæŸä¸€ä¸ªlayerçš„embeddingåƒè¿›å»ï¼Œå°è¯•"é‡å»º"åŸå§‹è¾“å…¥ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡å»ºåçš„è¾“å‡ºäº†è§£åˆ°â€”â€”å¦‚æœè¯´é‡Œé¢ä¸€å±‚layeré™¤å»äº†è¯­è€…çš„å£°éŸ³ç‰¹å¾ï¼Œåªä¿ç•™äº†å£°éŸ³è®¯å·å†…å®¹æ‰€å®Œæˆäº†è¿™æ ·ä¸€ä¸ªæµç¨‹ã€‚

    ![image-20220408132106321](https://s1.328888.xyz/2022/05/04/htaRA.png)

    å¦ä¸€ä¸ªä¾‹å­ï¼š5å±‚çš„biLSTMã€‚å£°éŸ³è®¯å·ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€æ®µæ–‡å­—ã€‚è¯­éŸ³è¾¨è¯†æ¨¡å‹ã€‚ç”·ç”Ÿå’Œå¥³ç”Ÿçš„å£°éŸ³èµ„æ–™åœ¨é€šè¿‡5å±‚çš„biLSTMåå£°è‰²æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«äº†ï¼ˆäººè€³æ— æ³•åŒºåˆ†ï¼‰ã€‚

    ![image-20220408150253152](https://s1.328888.xyz/2022/05/04/htkvS.png)

    ä¸Šå›¾å¦ä¸€ä¸ªä¾‹å­ï¼Œ3å±‚çš„CNNå’Œ3å±‚çš„BiLSTMã€‚è¾“å…¥æœ‰èƒŒæ™¯éŸ³ï¼Œåœ¨ç¬¬ä¸€å±‚LSTMæ»¤æ‰äº†å¤§åŠèƒŒæ™¯å£°ã€‚

***

### _**Global Explanation**_

ä»¥å›¾ç‰‡åˆ†ç±»ä¸ºä¾‹ï¼Œå‡å®šæˆ‘ä»¬è¿˜æ²¡æœ‰å¼€å§‹å¯¹æ•°æ®é›†è¿›è¡Œclassifyï¼Œæˆ‘ä»¬éœ€è¦å¯¹classifyæ•´ä¸ªmodelçš„å‚æ•°ç‰¹å¾åšå‡ºè§£é‡Šï¼ˆä¾‹å¦‚è¯´ä»€ä¹ˆæ ·çš„ä¸œè¥¿å¯ä»¥æ˜¯ä¸€åªçŒ«ï¼Œå¦‚æœåˆ†ç±»ä»»åŠ¡ä¸­åŒ…å«çŒ«å’ªçš„è¯ï¼‰ï¼Œå¯¹ä¸€ä¸ªnetworkè€Œè¨€ä¸€åªçŒ«åº”è¯¥é•¿ä»€ä¹ˆæ ·å­ã€‚è€Œä¸æ˜¯é’ˆå¯¹æŒ‡å®šæ•°æ®ï¼ˆç‚¹/å›¾ç‰‡ï¼‰çš„è¿›è¡Œåˆ†ææˆ–ç»“æœã€‚

E.g.å‡å®šå·²æœ‰ä¸€ä¸ªtrainå¥½çš„CNNï¼Œé‡Œé¢æœ‰è‹¥å¹²å±‚å·ç§¯å±‚ï¼ˆConv Layerï¼‰ï¼Œæœ‰ä¸€å †filterã€‚ä¸€å¼ å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œconv layerè¾“å‡ºä¸€ä¸ªfeature mapï¼Œé‚£æ¯ä¸€ä¸ªfilteréƒ½ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªmetric

![image-20220408154233822](https://s1.328888.xyz/2022/05/04/ht1LR.png)

å‡è®¾è¾“å…¥ä¸€å¼ å›¾ç‰‡$X$ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªçŸ©é˜µã€‚æŠŠå›¾ç‰‡ä¸¢è¿›è¿™ä¸ªCNNé‡Œè¾¹ï¼Œæˆ‘ä»¬ä¼šå‘ç°æŸä¸€ä¸ªfilterï¼ˆå‡è®¾filter1ï¼‰åœ¨å®ƒçš„feature mapé‡Œé¢æœ‰å‡ ä¸ªä½ç½®æœ‰æ¯”è¾ƒå¤§çš„å€¼ï¼ˆlarge valuesï¼‰â€”â€”æ„å‘³ç€è¿™ä¸ªå›¾ç‰‡é‡Œæœ‰å¾ˆå¤šçš„patternæ˜¯ç”±filter1è´Ÿè´£ä¾¦æµ‹çš„ã€‚

æˆ‘ä»¬æƒ³è¦çŸ¥é“çš„æ˜¯å¯¹äºfilter1è€Œè¨€ï¼Œå…¶ç†æƒ³çš„patternçš„feature mapç©¶ç«Ÿé•¿ä»€ä¹ˆæ ·å­â€”â€”æ€ä¹ˆåšï¼Ÿç­”ï¼šæˆ‘ä»¬/æœºå™¨å¯ä»¥åˆ›é€ å‡ºä¸€å¼ å›¾ç‰‡

filter1çš„feature mapæ˜¯ä¸€ä¸ªçŸ©é˜µï¼ŒçŸ©é˜µé‡Œæ¯ä¸€ä¸ªå…ƒç´ è®°ä½œ$a\_{ij}$ï¼Œæˆ‘ä»¬æŠŠè¦æ‰¾çš„é‚£å¼ å›¾ç‰‡$X$å½“ä½œä¸€ä¸ªæœªçŸ¥å˜é‡ï¼Œå½“ä½œæˆ‘ä»¬è¦è®­ç»ƒçš„é‚£ä¸ªå‚æ•°ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™ä¸ªæœªçŸ¥å˜é‡ä¸¢è¿›CNNä»¥åï¼Œæˆ‘ä»¬è€ƒå¯Ÿçš„filterçš„ä½ç½®æ‰€è¾“å‡ºçš„feature mapç†æƒ³æƒ…å†µä¸‹çŸ©é˜µçš„$a\_{ij}$æ€»å’Œè¦è¶Šå¤§è¶Šå¥½ã€‚ç»¼ä¸Šï¼Œæ»¡è¶³

$$
X^* = arg \ \underset{X}{max}\sum_i\sum_ja_{ij}
$$

è¿™ä¸ª$X^_$ä¸æ˜¯æ•°æ®é›†é‡Œé¢ä¸€å¼ ç‰¹å®šçš„å›¾ç‰‡ï¼›æˆ‘ä»¬æŠŠ$X^_$ä¸¢è¿›CNNä¸­ï¼Œçœ‹filter1è¾“å‡ºçš„feature mapï¼Œå€¼è¶Šå¤§è¶Šå¥½ã€‚ï¼ˆåŸç†ï¼šgradient ascentï¼‰

![image-20220408230052524](https://s1.328888.xyz/2022/05/04/htF1v.png)

ä»¥æ‰‹å†™æ•°å­—åˆ†ç±»å™¨ä¸ºä¾‹ï¼ˆdigit classifierï¼‰ï¼Œæˆ‘ä»¬æŒ‰ç…§ä»¥ä¸Šæ–¹æ³•æƒ³æ‰¾åˆ°ç½‘ç»œä¸­é—´çš„filterçš„ç†æƒ³çš„feature mapé•¿ä»€ä¹ˆæ ·ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°ç½‘ç»œæœ€åçš„outputï¼ˆä»¤å„è‡ªåˆ†ç±»ç½®ä¿¡åº¦æœ€é«˜ï¼‰ã€‚

![image-20220408230707159](https://s1.328888.xyz/2022/05/04/htZu0.png)

å®é™…ä¸Šï¼Œfilterç¡®å®è¡¨è¾¾å‡ºå…¶æƒ³çœ‹åˆ°çš„featureï¼Œä¾‹å¦‚æ¨ªçº¿ã€ç›´çº¿ã€æ–œç›´çº¿ç­‰

![image-20220408230732858](https://s1.328888.xyz/2022/05/04/htjdJ.png)

å¯æ˜¯ï¼Œå¯¹äºåˆ†åˆ«è®¾ç½®é«˜ç½®ä¿¡åº¦maximumå‡ºæ¥ï¼ˆåˆ›é€ å‡ºæ¥çš„ï¼‰å›¾ç‰‡$X^\*$ï¼Œçœ‹èµ·æ¥å®åœ¨æ²¡ä»€ä¹ˆåŒºåˆ«ï¼

å¦‚æœæˆ‘ä»¬æƒ³è¦å›¾ç‰‡$X^\*$å¾—åˆ°äººå¯ä»¥æƒ³è±¡ï¼ˆè‚‰çœ¼è¯†åˆ«çš„ï¼‰æ•°å­—å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ç‚¹é™åˆ¶ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬åŠ ä¸€ä¸ªå¯¹æ•°å­—çš„æœŸæœ›$R(x)$ï¼Œè¿™ä¸ª$R(x)$è¡¨ç¤ºhow likely $X$ is a digitï¼Œè¿™é‡Œçš„

$$
R(x) = -\sum_{i,j}|X_{ij}|
$$

![image-20220408231234323](https://s1.328888.xyz/2022/05/04/ht6EW.png)

åœ¨æ–‡çŒ®https://arxiv.org/abs/1506.06579ï¼Œçˆ†è°ƒè¶…å‚æ•°ï¼Œå„ç§æ­£åˆ™åŒ–â€¦â€¦â€œåæ¨â€å¾—åˆ°

![image-20220408231356423](https://s1.328888.xyz/2022/05/04/htNAy.png)

#### æœ‰æ•ˆçš„ä¸€æ‹›ï¼šConstraint from Generator

*   trainä¸€ä¸ªimageçš„generatorï¼Œå¯ä»¥ç”¨GAN or VAE

    ![image-20220408231643088](https://s1.328888.xyz/2022/05/04/hto6d.png)
*   Image Generatorå’Œåˆ†ç±»å™¨è¿æ¥ä¸€å—ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å‡½æ•°å°±æ˜¯

    $$
    z^* = arg \ \underset{z}{max}\ y_i
    $$

    æ‰¾å‡ºæ¥çš„å›¾ç‰‡é•¿ä»€ä¹ˆæ ·ï¼š$X^\* = G(z^\*)$

    ![image-20220408231931764](https://s1.328888.xyz/2022/05/04/htEXQ.png)
* å¾ˆworkï¼ˆè¡¨é¢ä¸Šçœ‹â€¦â€¦ï¼‰ï¼Œæ„Ÿè§‰å°±æ˜¯å¼ºè¡Œè§£é‡Šâ€¦â€¦ï¼ˆè‡ªæ¬ºæ¬ºäººï¼‰

## Outlook

ç”¨ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ¨¡å‹æ¥æ¨¡ä»¿æ¯”è¾ƒå¤æ‚çš„æ¨¡å‹ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“ç®€å•æ¨¡å‹çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ç”±æ­¤çŸ¥é“å¤æ‚æ¨¡å‹çš„è¡Œä¸ºã€‚

> æœ‰ç‚¹åƒåŒæ€çš„æ€æƒ³

![image-20220408232358931](https://s1.328888.xyz/2022/05/04/htPC3.png)

ï¼ˆå¼¹å¹•æœ‰æåˆ°çŸ¥è¯†è’¸é¦â€¦â€¦ï¼‰

> \*Local Interpretable Model-Agnostic Explanations (LIME)ï¼šé˜…è¯»æ–‡çŒ®ä»¥åŠä½œä¸š
