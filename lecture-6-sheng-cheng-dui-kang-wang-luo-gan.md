# Lecture 6ï¼š ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰

> Lectured by HUNG-YI LEE (æå®æ¯…) Recorded by Yusheng zhaoï¼ˆyszhao0717@gmail.comï¼‰

***

\[TOC]

***

> Network as Generatorï¼š
>
> ä¹‹å‰å­¦åˆ°çš„Networkéƒ½æ˜¯ä¸€ä¸ªfunctionï¼šx $=>$Network $=>$y
>
> è¿™ä¸ªLectureçš„ä¸»é¢˜æ˜¯æŠŠNetworkçœ‹ä½œæ˜¯ä¸€ä¸ªGeneratorï¼Œä½œæ·±å±‚ä½¿ç”¨ï¼Œè¿™ä¸ªnetworkç‰¹åˆ«çš„åœ°æ–¹æ˜¯è¾“å…¥ä¼šåŠ ä¸Šä¸€ä¸ªrandomçš„variable $z$ï¼šç½‘ç»œçš„è¾“å…¥ä¸ä»…æœ‰$x$ï¼Œè¿˜æœ‰Simple Distributionçš„åˆ†å¸ƒ$z$ï¼Œ$y$æ˜¯åŒæ—¶çœ‹$x$å’Œ$z$çš„è¾“å‡ºã€‚
>
> networkæ€ä¹ˆåŒæ—¶çœ‹$x$å’Œ$z$å‘¢ï¼Ÿæœ‰å¾ˆå¤šä¸åŒçš„åšæ³•ï¼Œå–å†³äºnetworkçš„æ¶æ„ã€‚ä¸¾ä¸ªæ —å­ï¼š$x$æ˜¯ä¸ªå‘é‡ï¼Œ$z$æ˜¯ä¸ªå‘é‡ï¼Œä¸¤è€…ç›´æ¥æ¥èµ·æ¥å˜æˆæ¯”è¾ƒé•¿çš„å‘é‡ä½œä¸ºä¸€ä¸ªè¾“å…¥ï¼›æˆ–è€…æ°å¥½$x$å’Œ$z$é•¿åº¦ä¸€æ ·ï¼Œé‚£ä¸¤è€…ç›¸åŠ åå½“ä½œè¾“å…¥ã€‚
>
> $z$ç‰¹åˆ«çš„åœ°æ–¹å°±æ˜¯å®ƒæ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šä¸€æ ·ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªdistributionä¸­sampleï¼ˆé‡‡æ ·ï¼‰å‡ºæ¥çš„ï¼Œè¿™ä¸ªdistributionï¼ˆæˆ‘ä»¬è‡ªå·±å†³å®šï¼‰å¿…é¡»å¤Ÿç®€å•ï¼šæˆ‘ä»¬çŸ¥é“è¿™ä¸ªåˆ†å¸ƒçš„å¼å­é•¿ä»€ä¹ˆæ ·å­ï¼Œæ¯”æ–¹è¯´é«˜æ–¯åˆ†å¸ƒï¼ˆGaussian Distributionï¼‰ã€å‡åŒ€åˆ†å¸ƒï¼ˆUniform Distributionï¼‰ã€‚éšç€æˆ‘ä»¬sampleåˆ°çš„$z$ä¸åŒï¼Œè¾“å‡º$y$ä¹Ÿä¼šä¸åŒã€‚æœ€åå¾—åˆ°çš„è¾“å‡ºæ„æˆä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒï¼ˆComplex Distributionï¼‰ã€‚
>
> è¿™ç§å¯ä»¥è¾“å‡ºä¸€ä¸ªdistributionçš„networkæˆ‘ä»¬ç§°ä¹‹ä¸º**Generator**ã€‚
>
> ![](https://s1.328888.xyz/2022/05/03/hrqRT.png)

## ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦Generatorï¼Ÿï¼ˆå³ä¸ºä»€ä¹ˆè¾“å‡ºéœ€è¦æ˜¯ä¸ªåˆ†å¸ƒï¼‰

ä»¥video predictionä¸ºä¾‹ï¼ŒæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰æ‰€å­¦è¿‡çš„supervised learningæ–¹æ³•ï¼Œå°†è¿‡å»çš„ç”»é¢å¸§ï¼ˆéƒ¨åˆ†ï¼‰è¾“å…¥Networkï¼Œè¾“å‡ºä¸€å¼ é¢„æµ‹çš„å¸§ï¼ˆéƒ¨åˆ†ï¼‰ï¼šä¼šå‡ºç°é¢„æµ‹ç”»é¢æ˜æ˜¾ä¸åˆç†çš„æƒ…å½¢ï¼ˆnetworkå˜æˆä¸€ä¸ªâ€œè€å¥½äººâ€ï¼Œå‡ºç°åŒä¸€ç§è¾“å…¥å¾—åˆ°å¤šç§è¾“å‡ºçš„æƒ…å½¢ï¼‰â€”â€”è§£å†³æ–¹æ³•ï¼šè®©è¾“å‡ºå‘ˆç°ä¸€ç§æ¦‚ç‡çš„ç‰¹å¾ï¼Œæˆ–è€…è¯´æ˜¯è¾“å‡ºä¸å›ºå®šï¼ˆåŒ…å«å¤šç§å¯èƒ½ï¼‰ã€‚

![](https://s1.328888.xyz/2022/05/03/hrD62.png)

ä¸Šå›¾ç›‘ç£å­¦ä¹ çš„çŠ¶å†µï¼Œä¸‹å›¾æ˜¯generatorçš„çŠ¶å†µğŸ‘‡

![](https://s1.328888.xyz/2022/05/03/hrlLM.png)

å› æ­¤ï¼Œ**å½“æˆ‘ä»¬çš„ä»»åŠ¡éœ€è¦ä¸€äº›åˆ›é€ åŠ›ï¼ˆcreativityï¼‰çš„æ—¶å€™**ï¼ˆæˆ–è€…è¯´æ˜¯the same input has different outputsï¼‰ï¼Œæˆ‘ä»¬éœ€è¦Generator

*   Drawing

    ![](https://s1.328888.xyz/2022/05/03/hrtC7.png)

    åŒæ ·çº¢çœ¼ç›çš„ç‰¹å¾ï¼Œå¯èƒ½ç»˜ç”»å‡ºæ¥çš„å¤´åƒä¸å¤ªä¸€æ ·ã€‚
*   Chatbot

    ![](https://s1.328888.xyz/2022/05/03/hr5bX.png)

    ä¸€ä¸ªQ\&Aç›¸ä¼¼çš„é“ç†ï¼Œå›ç­”ä¹Ÿæœ‰ä¸ä¸€æ ·â€¦â€¦

ä¸Šè¿°ä¸¤ä¸ªä¾‹å­äºŒåˆºèˆæµ“åº¦è¿‡é«˜â€¦â€¦è€å¸ˆä¸€æœ¬æ­£ç»çš„èƒ¡è¯´å…«é“ï¼š)

ä¸Šé¢ç®€å•è¯´æ˜äº†æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªå…·æœ‰generatorçš„modelï¼Œä¸”è¿™ä¸ªmodelæ˜¯åšæ€æ ·å­çš„ä»»åŠ¡çš„ã€‚

å…¶ä¸­ä¸€ä¸ªæœ€è‘—åçš„modelç§°ä¹‹ä¸º**Generative Adversarial Networkï¼ˆGANï¼‰**

## ä»‹ç»Generative Adversarial Networkï¼ˆGANï¼‰

> GANæ€ä¹ˆå¿µï¼Ÿâ€”â€”æ·¦ï¼Œå®Œæ¯•ã€‚
>
> Generative Adversarial Networksï¼ˆarxivï¼š[https://arxiv.org/abs/1406.2661](https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1406.2661)ï¼‰
>
> [GANçš„åŠ¨ç‰©å›­](https://github.com/hindupuravinash/the-gan-zoo)â€”â€”æ”¶é›†äº†è¶…è¿‡äº”ç™¾ç§çš„å˜ç§GAN

ä»¥Anime Face Generationä¸ºä¾‹ï¼Œ

*   é¦–å…ˆè¯´æ˜_**Unconditional generation**_ï¼ˆè¾“å…¥æ‹¿æ‰äº†$x$ï¼Œåªä¿ç•™äº†åˆ†å¸ƒ$z$ï¼‰

    è¾“å…¥$z$ï¼ˆä¸€ä¸ªä»Normal Distributioné‡‡æ ·å‡ºæ¥çš„ä¸€ä¸ªå‘é‡ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª_Low-dim vector_ï¼Œç»´æ•°ç”±è‡ªå·±å†³å®šçš„ï¼‰ï¼ŒæŠŠ$z$ä¸¢è¿›ä¸€ä¸ªGeneratoré‡Œé¢ï¼Œè¾“å‡ºä¸€ä¸ªå¯¹åº”çš„å‘é‡$y$ï¼ˆæ»¡è¶³Complex Distributionï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª_high-dim vector_ï¼Œè¿™æ ·æ¯ä¸€ä¸ªé«˜ç»´çš„å‘é‡å…¶å®å°±å¯¹åº”ä¸€ä¸ªç”Ÿæˆçš„å›¾åƒï¼‰

    ![](https://s1.328888.xyz/2022/05/03/hrzuZ.png)

    æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼Œä¸ç®¡å·¦è¾¹è¾“å…¥çš„$z$æ˜¯æ€æ ·çš„å‘é‡ï¼Œéƒ½ä¼šè¾“å‡ºä¸€ä¸ªäºŒåˆºèˆè„¸å›¾åƒï¼ˆå‘é‡ï¼‰

    * ä¸ºä»€ä¹ˆè¿™è¾¹æ˜¯normal distributionï¼ˆæ­£æ€åˆ†å¸ƒï¼‰å‘¢ï¼Ÿå¯ä»¥ç”¨åˆ«çš„å—ï¼Ÿâ€”â€”å½“ç„¶å¯ä»¥ç”¨åˆ«çš„ï¼Œå®è·µè¯æ˜ä¸åŒçš„åˆ†å¸ƒå¯èƒ½åŒºåˆ«å¹¶æ²¡æœ‰çœŸçš„éå¸¸å¤§ã€‚å¯ä»¥æ¢è®¨å¾ˆå¤šæ–‡çŒ®ï¼Œæœ‰è®¾è®¡å®éªŒéªŒè¯ä¸åŒåˆ†å¸ƒçš„åŒºåˆ«ã€‚è¿™ä¸ªä»»åŠ¡çš„è¦æ±‚åªéœ€è¦è¾“å…¥$z$çš„åˆ†å¸ƒè¶³å¤Ÿç®€å•ï¼Œé€‰æ‹©distributionçš„ä»»åŠ¡å¯ä»¥äº¤ç»™generatorå®ç°ã€‚
*   _**Discriminator**_

    ä½œç”¨ï¼šæ‹¿ä¸€å¼ å›¾åƒä½œä¸ºè¾“å…¥ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼ˆæˆ–è€…è¯´æ˜¯ä¸€ä¸ªfunctionï¼‰ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªæ•°å­—ï¼ˆæ ‡é‡scalarï¼Œè¿™ä¸ªæ•°å­—è¶Šå¤§å°±è¯´æ˜è¿™ä¸ªè¾“å…¥è¶Šåƒæ˜¯çœŸå®çš„äºŒåˆºèˆäººç‰©çš„å›¾åƒï¼‰

    ![](https://s1.328888.xyz/2022/05/03/hrCdC.png)

    Generatoræ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒæ ·çš„discriminatorä¹Ÿæ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæ¶‰åŠåˆ°çš„ç½‘ç»œæ¶æ„å®Œå…¨å¯ä»¥è‡ªå·±è®¾è®¡ï¼šå¯ä»¥æ˜¯CNNï¼Œäº¦å¯ä»¥æ˜¯transformerâ€”â€”åªè¦èƒ½å¤Ÿäº§ç”Ÿæˆ‘ä»¬æ‰€éœ€è¦çš„è¾“å…¥è¾“å‡ºéƒ½å¯ä»¥ã€‚
*   _**Basic Idea of GAN**_

    æ¯å¶è¶çš„ä¾‹å­ï¼šå¤©æ•Œçš„å­˜åœ¨å¯¼è‡´ï¼ŒåŸæ¥äº”å½©æ–‘æ–“çš„æ¯å¶è¶ç¥–å…ˆé¢œè‰²å°±è½¬å˜ä¸ºæ¯å¶èˆ¬çš„æ£•è‰²ã€‚åŒæ—¶ï¼Œå¤©æ•Œä¹Ÿåœ¨è¿›åŒ–äº†ï¼Œè¾¨åˆ«æ¯å¶è¶çš„èƒ½åŠ›åŠ å¼ºäº†ï¼›äºæ˜¯ä¹ï¼Œæ¯å¶è¶ç»§ç»­è¿›åŒ–ï¼Œç”Ÿé•¿å‡ºç±»ä¼¼â€œå¶è„‰â€ï¼Œæ›´åƒæ¯å¶ï¼›å‘¨è€Œå¤å§‹ï¼Œå¤©æ•Œè¿›åŒ–ï¼ŒçŒç‰©ä¹Ÿå†è¿›åŒ–â€¦â€¦

    å¯¹åº”åˆ°GANä¸Šï¼ŒçŒç‰©å°±æ˜¯Generatorï¼Œå¤©æ•Œå°±æ˜¯Discriminator

    ![](https://s1.328888.xyz/2022/05/03/h4tey.png)

    æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯generatorç”»å‡ºäºŒåˆºèˆçš„äººç‰©ï¼Œå®ƒæ˜¯æŒ‰ç…§ä»¥ä¸‹æ–¹å¼è¿­ä»£çš„ğŸ‘‡

    ![](https://s1.328888.xyz/2022/05/03/hrpKg.png)

    ç¬¬ä¸€ä»£çš„generatorçš„å‚æ•°å‡ ä¹æ˜¯éšæœºçš„ï¼Œå¾—åˆ°çš„å›¾åƒæ˜¯å‡Œä¹±çš„æ‚è®¯ï¼Œç¬¬ä¸€ä»£discriminatorçš„ä»»åŠ¡å°±æ˜¯generatorçš„è¾“å‡ºå’ŒçœŸå®çš„å›¾åƒï¼ˆground truthï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ˆä¸¾ä¾‹è¯´æœ‰æ²¡æœ‰ä¸¤ä¸ªåœ†çƒï¼ˆçœ¼ç›ï¼‰ï¼‰ï¼›ç¬¬äºŒä»£generatorç›¸æ¯”è¦è¿›è¡Œâ€œè¿›åŒ–â€â€”â€”ä¸ºäº†â€œéª—â€è¿‡ç¬¬ä¸€ä»£discriminatorï¼ˆæ¯”æ–¹è¯´è¿›åŒ–å‡ºçœ¼ç›ï¼‰ï¼Œè€Œç¬¬äºŒä»£discriminatorä¹Ÿéšä¹‹è¿›åŒ–ï¼Œè¯•å›¾åˆ†è¾¨ç¬¬äºŒä»£å›¾ç‰‡é—´çš„å·®å¼‚ï¼›å‘¨è€Œå¤å§‹ï¼Œæ¯”å­¦èµ¶å¸®è¶…â€¦â€¦generatoräº§ç”Ÿå‡ºdiscriminatorè¾“å‡ºè¾ƒå¤§çš„äºŒåˆºèˆäººç‰©å›¾åƒã€‚

    æ—©æœŸçš„è®ºæ–‡ï¼Œæè¿°Generatorå’ŒDiscriminatorçš„å…³ç³»å°±æ˜¯\*\*â€œadversarialâ€\*\*ï¼ˆå¯¹æŠ—çš„ï¼‰â€”â€”äº¦æ•Œäº¦å‹çš„å…³ç³»ï¼ˆNarutoå’ŒSasukeâ€¦â€¦ï¼‰
*   _**ä»ç®—æ³•è§’åº¦çœ‹å¾…Generatorå’ŒDiscriminator**_ã€Algorithmã€‘

    ä¸¤ä¸ªnetworkï¼ˆæ¯ä¸ªnetworkæœ‰å¥½å‡ å±‚ï¼‰ï¼š

    * åˆå§‹åŒ–Generatorå’ŒDiscriminatorçš„å‚æ•°ï¼šGå’ŒD
    * åœ¨æ¯ä¸ªiterationï¼š
      *   _**STEP 1**_ï¼šå›ºå®šä½generator Gï¼Œç„¶ååªè®­ç»ƒï¼ˆæ›´æ–°ï¼‰discriminator D

          åˆå§‹åŒ–æ­¥éª¤ä¸­ï¼Œä»é«˜æ–¯åˆ†å¸ƒrandomly sampleåˆ°low-dimçš„å‘é‡ï¼Œè¾“å…¥generatorä¸­å¾—åˆ°è¾“å‡ºçš„high-dimçš„å‘é‡ï¼ˆå›¾åƒï¼‰å¤§æ¦‚ç‡éå¸¸ä¸åƒäºŒæ¬¡å…ƒå›¾åƒã€‚

          æˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªdatabaseï¼ˆä¼šæœ‰å¾ˆå¤šäºŒåˆºèˆå›¾åƒï¼‰ï¼Œæˆ‘ä»¬ä»è¿™ä¸ªdatabaseä¸­sampleå‡ºä¸€äº›å›¾åƒå‡ºæ¥ï¼Œæ‹¿çœŸæ­£çš„äºŒæ¬¡å…ƒå¤´åƒå’ŒGçš„ç»“æœä¸€èµ·å»è®­ç»ƒæˆ‘ä»¬çš„discriminator

          discriminatorçš„è®­ç»ƒç›®æ ‡æ˜¯è¦åˆ†åˆ«å‡ºgeneratorå’Œground truthçš„å·®å¼‚ã€‚å®é™…çš„æ“ä½œå¯èƒ½æ˜¯è¿™æ ·å­çš„ï¼šè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œground truthä¸º1ï¼Œgenerator objectsä¸º0ï¼Œåšä¸€ä¸ªäºŒåˆ†ç±»çš„reä»»åŠ¡ï¼›å½“ç„¶ä¹Ÿå¯ä»¥å½“ä½œå›å½’é—®é¢˜æ¥åšã€‚

          ![](https://s1.328888.xyz/2022/05/03/h4dnW.png)
      *   _**STEP 2**_ï¼šå›ºå®šä½discriminator Dï¼Œç„¶ååªè®­ç»ƒï¼ˆæ›´æ–°ï¼‰generator G

          generatorçš„è®­ç»ƒç›®æ ‡å°±æ˜¯è¦è¾“å‡ºçš„å‘é‡ï¼ˆå›¾åƒï¼‰èƒ½å¤Ÿä»¥å‡ä¹±çœŸï¼Œéª—è¿‡discriminator

          æˆ‘ä»¬æœ‰ä¸€ä¸ªgeneratorï¼Œä»é«˜æ–¯åˆ†å¸ƒrandomly sampleåˆ°low-dimçš„å‘é‡ä½œä¸ºè¾“å…¥ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªå›¾ç‰‡ï¼Œå°†å›¾ç‰‡ä¸¢è¿›discriminatorï¼Œäº§ç”Ÿä¸€ä¸ªåˆ†æ•°ã€‚discriminatorçš„å‚æ•°æ˜¯å›ºå®šçš„ï¼Œè¿™æ—¶å€™éœ€è¦è°ƒæ•´generatorçš„å‚æ•°

          ![](https://s1.328888.xyz/2022/05/03/h4DWF.png)

          å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¼šæŠŠgeneratorå’Œdiscriminatoræ¥èµ·æ¥ï¼Œçœ‹ä½œæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„networkï¼ˆlarge networkï¼‰ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå±‚ï¼ˆå‰é¢æ›´æ–°è°ƒæ•´å‚æ•°ï¼Œåé¢å‡ å±‚å‚æ•°å›ºå®šï¼‰ï¼Œå…¶ä¸­æœ‰ä¸€å±‚å¾—åˆ°çš„è¾“å‡ºå¾ˆå®½ï¼Œå®ƒçš„dimensionå°±å’Œå›¾ç‰‡é‡Œé¢çš„pixelæ•°ç›®ä¹˜ä¸‰æ˜¯ä¸€æ ·çš„ï¼Œæ•´ç†ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡è¾“å‡ºï¼ˆå›¾ç‰‡ï¼‰ã€‚è¿™ä¸ªnetworkçš„è®­ç»ƒæ–¹æ³•å’Œæˆ‘ä»¬ä¹‹å‰è®²çš„æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯å…¶ç›®æ ‡discriminatorçš„è¾“å‡ºæ˜¯è¶Šå¤§è¶Šå¥½ã€‚
      *   _**STEP 3**_ï¼šæ¥ä¸‹æ¥ï¼Œå°±æ˜¯åå¤çš„è®­ç»ƒdiscriminatorå’Œgeneratorï¼Œé‡å¤_**STEP 1**_å’Œ_**STEP 2**_

          ![](https://s1.328888.xyz/2022/05/03/h45qk.png)

          æœ€åå¾—åˆ°ä¸€ä¸ªgeneratorèƒ½å¤Ÿç”Ÿæˆä»¥å‡ä¹±çœŸçš„å›¾ç‰‡ï¼Œé‚£ä¹ˆè®­ç»ƒä»»åŠ¡å°±ç»“æŸäº†ã€‚
*   äºŒæ¬¡å…ƒäººç‰©å¤´åƒç”Ÿæˆå®æˆ˜

    > [GANå­¦ä¹ æŒ‡å—ï¼šä»åŸç†å…¥é—¨åˆ°åˆ¶ä½œç”ŸæˆDemo - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/24767059)

2019å¹´ï¼Œç”¨styleGANåšçš„äºŒæ¬¡å…ƒäººç‰©å¤´åƒï¼Œhttps://www.gwern.net/Faces

*   é™¤äº†äº§ç”ŸåŠ¨ç”»äººè„¸ï¼Œä¹Ÿå¯ä»¥ç”¨GANäº§ç”ŸçœŸå®äººè„¸

    > [Progressive GAN](https://arxiv.org/abs/1710.10196)

å¯¹äºä¸¤å¼ ç”Ÿæˆçš„äººè„¸å›¾åƒï¼Œä¸¤ä¸ªå‘é‡ä¹‹é—´ä¸æ–­åšå†…æ’ï¼ˆinterpolationï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªäººç‰©ä¹‹é—´çš„æ¸å˜

![](https://s1.328888.xyz/2022/05/03/h4zBQ.png)

è¿™ä¸ªæ¸å˜å¯ä»¥è¡¨ç°ä¸ºäººç‰©è¡¨æƒ…çš„å˜åŒ–ï¼Œçœ¼ç¥æ–¹å‘çš„å˜åŒ–ã€‚

ä»¥ä¸Šç”¨å®ä¾‹è¯´æ˜äº†GANçš„å®é™…è¿ä½œæ˜¯å¦‚ä½•çš„ï¼Œä»¥ä¸‹ä»ç†è®ºä¸Šè¯´æ˜ä¸ºä»€ä¹ˆGeneratorå’ŒDiscriminatorçš„äº’åŠ¨å¯ä»¥è®©Generatorå¯ä»¥äº§ç”Ÿåƒæ˜¯çœŸæ­£äººè„¸çš„å›¾ç‰‡ã€‚

***

## Theory behind GAN

æˆ‘ä»¬è®­ç»ƒçš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€”ä»¥æˆ‘ä»¬ä¹‹å‰è®²çš„ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œæˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªloss functionï¼Œç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸æ–­åœ°minimizeè¿™ä¸ªloss functionå°±è¡Œäº†ã€‚è€Œåœ¨è¿™ä¸ªGeneratoråœ°é—®é¢˜é‡Œï¼Œæˆ‘ä»¬è¦minimizeä¸¤ä¸ªdscriminatorçš„å·®è·ï¼Œå¦‚ä¸‹å›¾ğŸ‘‡

![](https://s1.328888.xyz/2022/05/03/h4p23.png)

æˆ‘ä»¬ä»Normal Distributionï¼ˆæ­£æ€åˆ†å¸ƒï¼‰ä¸­sampleå‡ºvectorä¸¢è¿›Generatoré‡Œé¢ï¼Œäº§ç”Ÿå‡ºä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„distributionï¼Œè¿™ä¸ªå¤æ‚çš„distributionè¢«ç§°ä¹‹ä¸º\*\*$P\_G$**ï¼Œè€Œground truthå³çœŸå®çš„æ•°æ®é›†å½¢æˆå¦ä¸€å®åœ¨çš„ä¸€ä¸ªdistributionè¢«ç§°ä¹‹ä¸º**$P\_{data}$\*\*ï¼Œæˆ‘ä»¬æœŸå¾…è¿™ä¸¤è€…è¶Šæ¥è¿‘è¶Šå¥½â€”â€”è¿™å°±æ˜¯æˆ‘ä»¬minimizeçš„ç›®æ ‡ã€‚

åˆ†å¸ƒçš„å¸ƒå±€å‡è®¾å¦‚ä¸‹â†“

![](https://s1.328888.xyz/2022/05/03/h40I4.png)

ä»¥ä¸Šï¼Œæˆ‘ä»¬æ€»ç»“è¿™æ ·ä¸€ä¸ªå¼å­ï¼š

$$
G^* = arg\space \underset{G}{min}\space Div(P_G,P_{data})
$$

å…¶ä¸­$Div(P\_G,P\_{data})$ä»£è¡¨$P\_G$å’Œ$P\_{data}$ä¹‹é—´çš„æ•£åº¦ï¼ˆDivergenceï¼‰ã€æˆ‘ä»¬å¯ä»¥æƒ³æˆæ˜¯ä¸¤ä¸ªdistributionä¹‹é—´çš„æŸç§è·ç¦»ï¼Œdivergenceæœ¬èº«å°±æ˜¯distributionçš„ä¸€ç§measureã€‘

**æˆ‘ä»¬å®é™…å·¥ä½œçš„ç›®æ ‡å°±æ˜¯ï¼šæ‰¾åˆ°ä¸€ç»„generatorçš„å‚æ•°ä½¿å¾—æŒ‰ä¸Šè¿°æ–¹æ³•ç»è¿‡generatoråå¾—åˆ°çš„$G^\*$è¶Šå°è¶Šå¥½**

> å…³äºæ•£åº¦ï¼ˆdivergenceï¼‰ï¼šè¿™é‡Œä¸è¯¦ç»†ä»‹ç»ï¼Œè¯¾å¤–å¦å¤–è¡¥å……å­¦ä¹ ã€‚æœ‰å¾ˆå¤šç§å®ç°æ–¹æ³•ï¼š**KL divergence**ã€JS Divergenceç­‰ç­‰

ä½†æ˜¯å®é™…ä¸Šåœ¨è®¡ç®—æ•£åº¦æ—¶ï¼Œä¼šæ¶‰åŠåˆ°å¤æ‚çš„ç§¯åˆ†ï¼ˆå®ä½œä¸Šå¯èƒ½å‡ ä¹ä¸çŸ¥é“æ€ä¹ˆè®¡ç®—ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬è®¡ç®—æ•£åº¦éå¸¸å›°éš¾ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰¾åˆ°é‚£ä¸ªç†æƒ³çš„$G^\*$ï¼Ÿâ€”â€”è¿™ä¸ªå°±æ˜¯åœ¨trainè¿™ç§generatorç»å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œè€ŒGANä»¥å¾ˆç¥å¥‡å·§å¦™çš„æ–¹å¼ï¼Œå¯ä»¥çªç ´è®¡ç®—æ•£åº¦çš„é™åˆ¶ã€‚ä»¥ä¸‹è¿›è¡Œä»‹ç»ğŸ‘‡

> Sampling is good enoughâ€¦â€¦

GANè¦æ±‚æˆ‘ä»¬åªéœ€è¦çŸ¥é“æ€ä¹ˆä»$P\_G$å’Œ$P\_{data}$è¿™ä¸¤ä¸ªåˆ†å¸ƒsampleä¸œè¥¿å‡ºæ¥ï¼Œå°±æœ‰åŠæ³•ç®—divergenceã€‚

* æŠŠçœŸå®çš„databaseæ‹¿å‡ºæ¥ï¼Œé‡Œé¢sampleä¸€äº›å°±å¯ä»¥ç»„æˆ$P\_{data}$
*   æŠŠnormal distributioné‡‡æ ·å‡ºæ¥çš„vectorè¾“å…¥è¿›generatorï¼Œäº§ç”Ÿä¸€å †è¾“å‡º-->å°±æ˜¯ä»$P\_G$é‡‡æ ·å‡ºæ¥çš„ç»“æœ

    ![](https://s1.328888.xyz/2022/05/03/h4sjB.png)

æ—¢ç„¶å·²ç»çŸ¥é“å¦‚ä½•sampleäº†ï¼Œé‚£ä¹ˆæ€ä¹ˆè®¡ç®—ï¼ˆä¼°ç®—ï¼‰divergenceå‘¢ï¼Ÿâ€”â€”è¿™éœ€è¦Discriminatorçš„åŠ›é‡ï¼Œæˆ‘ä»¬æ ¹æ®sampleå‡ºæ¥çš„dataï¼ˆåˆ†åˆ«æ¥è‡ª$P\_G$å’Œ$P\_{data}$ï¼‰æ¥å¯¹Discriminatorè¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒçš„ç›®æ ‡å°±æ˜¯å½“çœ‹åˆ°Real dataï¼ˆfrom $P\_{data}$ï¼‰æ—¶ï¼Œç»™æ¯”è¾ƒé«˜çš„åˆ†æ•°ï¼Œè€Œçœ‹åˆ°generative dataæ—¶ï¼Œå°±ç»™æ¯”è¾ƒä½çš„åˆ†æ•°ã€‚https://arxiv.org/abs/1406.2661

å‡å¦‚æŠŠå®ƒçœ‹ä½œæ˜¯Optimizationçš„é—®é¢˜ï¼Œæ€»ç»“ä¸ºä»¥ä¸‹ä»»åŠ¡ï¼šè®­ç»ƒä¸€ä¸ªDiscriminator

> éœ€è¦maximizeçš„ç§°ä¹‹ä¸º**Objective Function**ï¼›å¯¹åº”çš„ï¼Œéœ€è¦minimizeçš„ç§°ä¹‹ä¸º**Loss Function**

**trainingï¼š**$D^\* = arg \space \underset{D}{max}\space V(D,G)$

**Objective Function** for Dï¼š$V(G,D) = E\_{y \sim P\_{data\}}\[logD(y)]+E\_{y \sim P\_G}\[log(1-D(y))]$

![](https://s1.328888.xyz/2022/05/03/h4IJT.png)

æˆ‘ä»¬éœ€è¦Dè¶Šå¤§è¶Šå¥½ï¼Œä¸Šé¢è¿™ä»¶äº‹æƒ…ç­‰åŒäºä¸€ä¸ª$P\_G$å’Œ$P\_{data}$çš„äºŒåˆ†ç±»å™¨ï¼ˆbinary classifierï¼‰

![](https://s1.328888.xyz/2022/05/03/h4Rz2.png)

ç›´è§‚ä¸Šæˆ‘ä»¬å¯ä»¥ç†è§£ï¼ŒObjective Functionçš„å€¼ï¼ˆåœ¨ç©·ä¸¾ä¸ºå¾—åˆ°æœ€å¤§å€¼ï¼‰å’Œdivergenceç›¸å…³ï¼Œè¯¦ç»†çš„è¯æ˜å‚è§GANçš„åŸå§‹è®ºæ–‡ã€‚

![](https://s1.328888.xyz/2022/05/03/h4YnM.png)

æˆ‘ä»¬æœ¬æ¥çš„ç›®æ ‡æ˜¯è¦æ‰¾ä¸€ä¸ªgeneratorï¼Œå»minimizeä¸¤ä¸ªåˆ†å¸ƒçš„divergenceï¼Œè€Œç”±ä¸Šè¿°çš„å…³ç³»ï¼Œæˆ‘ä»¬ä½•ä¸å¦¨ç”¨è®­ç»ƒç›®æ ‡**Objective Functionï¼š**$\underset{D}{max}V(G,D)$æ¥æ›¿æ¢åŸæœ‰ç›®æ ‡ï¼Œæ±‚divergenceçš„è¾ƒå¤§å€¼ï¼Œè®°ä¸º$V(D,G)$ï¼Œç»¼ä¸Šï¼Œæˆ‘ä»¬è½¬æ¢ä»»åŠ¡ï¼Œå¾—ï¼š

$$
Generator:G^* = arg \space \underset{G}{min} \space \underset{D}{max}V(G,D) \\ Discriminator:D^* = arg \space \underset{D}{max}V(D,G)
$$

å…¶ä¸­the maximum objective valueï¼ˆ$\underset{D}{max}V(G,D)$ï¼‰å’Œ**JS divergence**ç›¸å…³ã€‚

æˆ‘ä»¬å¯ä»¥æ”¹å˜ï¼ˆè‡ªå·±å®šä¹‰ï¼‰objective functionï¼Œä»è€Œè¡¡é‡å„ç§å„æ ·å¾—divergenceï¼ˆæ•£åº¦ï¼‰ï¼Œåœ¨[æ–‡ç« ](https://arxiv.org/abs/1606.00709)ä¸­ï¼ˆF GANï¼‰ï¼Œæ€»ç»“äº†è®¸å¤šæ–¹æ³•ï¼Œusing the divergence you like.

> $D \rightarrow G$
>
> ![](https://s1.328888.xyz/2022/05/03/h4ce7.png)

> ![](https://s1.328888.xyz/2022/05/03/h4mDX.png)

ä¸åŒçš„divergenceï¼Œå»æ€æ ·è®¾è®¡objective functionï¼Œè¿™ç¯‡æ–‡ç« éƒ½æœ‰è¯¦ç»†çš„è®°è½½ã€‚

æ›¾ç»æœ‰äººè§‰å¾—GANæ²¡æœ‰å¾ˆå¥½çš„trainæ˜¯å› ä¸ºdivergenceæ²¡æœ‰å»å¾ˆå¥½çš„è®¡ç®—ï¼Œä½†æ˜¯F GANè¿™ç¯‡æ–‡ç« è¯´æ˜äº†å³ä½¿æ˜¯ç²¾è‡´çš„è®¾è®¡äº†divergenceçš„è¿‘ä¼¼çš„è®¡ç®—ï¼ŒGANä¹Ÿä¾æ—§ä¸å¥½trainâ€¦â€¦

ä»¥ä¸‹ä»‹ç»GANè®­ç»ƒçš„å°tipsã€‚

***

## Tips for GAN

> JS divergenceæœ‰ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Ÿ
>
> *   åœ¨ç»å¤§å¤šæ•°caseé‡Œé¢ï¼Œ$P\_G$å’Œ$P\_{data}$é‡å çš„éƒ¨åˆ†éå¸¸å°‘ï¼ˆare not overlappedï¼‰
>
>     *   ç†ç”±1ï¼šdataæœ¬èº«çš„ç‰¹æ€§ï¼Œç”±äºå›¾åƒæœ¬èº«æ˜¯é«˜ç»´çš„ï¼Œä»£è¡¨å›¾åƒçš„å‘é‡å°±æ˜¯å¤„äºé«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´çš„**manifoldï¼ˆæµå½¢ï¼‰**ã€‚å¯¹äºä¸€ä¸ªç±»åˆ«çš„å›¾åƒæœ¬èº«ï¼ˆè­¬å¦‚äºŒæ¬¡å…ƒå¤´åƒï¼‰ï¼Œåˆ†å¸ƒçš„åŒºé—´æ˜¯éå¸¸ç‹­çª„çš„ã€‚
>
>         > æµå½¢æ˜¯ä¸€ç§ç©ºé—´ï¼Œä¸€ä¸ªæµå½¢å¥½æ¯”æ˜¯ä¸€ä¸ª d ç»´çš„ç©ºé—´ï¼Œåœ¨ä¸€ä¸ª m ç»´çš„ç©ºé—´ä¸­ (m > d) è¢«æ‰­æ›²ä¹‹åçš„ç»“æœï¼ˆä¸€èˆ¬ç»´åº¦å‹ç¼©çš„æ–¹æ³•ä¸­éƒ½ä¼šæåˆ°è¿™ä¸ªè¯ï¼Œè°±èšç±»ä¸­å°±æœ‰æ¶‰åŠè¿™ä¸ªæ€æƒ³ï¼Œç¨åå†è¯´ï¼‰ï¼Œå¯ä»¥ç±»ä¼¼äºåœ°çƒï¼Œåœ°çƒçš„è¡¨é¢æ˜¯ä¸€ä¸ªçƒé¢
>
>         ![](https://s1.328888.xyz/2022/05/03/h43BC.png)
>
>         ä»äºŒç»´ç©ºé—´çš„è§’åº¦ï¼Œ$P\_G$å’Œ$P\_{data}$éƒ½æ˜¯äºŒç»´ç©ºé—´ä¸Šçš„ä¸¤æ¡ç›´çº¿ï¼Œé™¤éå®ƒä¿©é‡åˆï¼Œé‚£ä¹ˆå®ƒä¿©ç›¸äº¤çš„éƒ¨åˆ†å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®°ã€‚
>     *   ç†ç”±2ï¼šSamplingï¼ˆé‡‡æ ·çš„è§’åº¦ä¸Šçœ‹ï¼‰ï¼Œå°½ç®¡$P\_G$å’Œ$P\_{data}$æ˜¯æœ‰ç›¸äº¤çš„ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬åšåˆæ­¥å¤„ç†çš„æ—¶å€™æ˜¯å…ˆrandomly sampleçš„ï¼Œé‚£ä¹ˆåœ¨è®­ç»ƒæ•°æ®ä¸­ç›¸äº¤çš„å°±æ›´å°‘äº†ã€‚
>
>         ![](https://s1.328888.xyz/2022/05/03/h4O8g.png)
>
>     ä»¥ä¸Šä¸¤ä¸ªç†ç”±è¯´æ˜äº†$P\_G$å’Œ$P\_{data}$æ˜¯å‡ ä¹æ²¡æœ‰é‡å çš„ã€‚
>
> å› æ­¤ï¼Œå¦‚æœè¿™ä¸¤ä¸ªåˆ†å¸ƒä¸é‡å ï¼Œé‚£**JS divergence**ä¼šç®—å‡ºæ¥å°±ä¸€ç›´æ˜¯$log2$ï¼›è‹¥é‡åˆï¼Œåˆ™ä¸º0
>
> ![](https://s1.328888.xyz/2022/05/03/h4kvt.png)
>
> JS divergenceæ— æ³•åæ˜ å‡º$P\_G$å’Œ$P\_{data}$çš„å·®åˆ«ä¼˜åŠ£ã€‚
>
> å¦‚æœä¸¤ä¸ªåˆ†å¸ƒä¸é‡å ï¼Œé‚£ä¹ˆåœ¨è®­ç»ƒä¸­äºŒåˆ†ç±»å™¨æ­£ç¡®ç‡å‡ ä¹ä¼šè¾¾åˆ°100%ï¼Œè¿™ç§è®­ç»ƒè¿‘ä¹æ— æ•ˆ...
>
> æ‰€ä»¥åœ¨æ—©æœŸçš„GANè®­ç»ƒä»¿ä½›æ˜¯ä¸€ç§é»‘é­”æ³•ï¼Œå¦‚æœæ— æ³•å®æ—¶çš„å»æ£€æŸ¥å°±æ— æ³•éªŒè¯trainçš„æ•ˆæœå¦‚ä½•ã€‚
>
> æ‰€ä»¥ç®€å•çš„è€Œåˆ†ç±»å™¨æ— æ³•æä¾›æœ‰æ•ˆçš„GANçš„è®­ç»ƒæ•ˆæœçš„åé¦ˆã€‚ä»¥ä¸‹ä»‹ç»æ”¹è‰¯çš„æ›¿ä»£å“WGANã€‚

### Wasserstein distanceï¼ˆearth mover distanceï¼‰

å‡è®¾ä¸¤ä¸ªåˆ†å¸ƒï¼š$P$å’Œ$Q$ã€‚æƒ³è±¡ä¸‹$P$æ˜¯åœŸå †ï¼ˆa pile of earthï¼‰è€Œ$Q$æ˜¯åœŸå †æ”¾çš„ç›®çš„åœ°ï¼ˆtargetï¼‰ã€‚è€Œ\*\*å¹³å‡è·ç¦»ï¼ˆaverage distanceï¼‰\*\*å°±æ˜¯æ¨åœŸæœºï¼ˆearth moverï¼‰æŠŠåœŸä»$P$åˆ°$Q$çš„è·ç¦»

![](https://s1.328888.xyz/2022/05/03/h41Le.png)

å¯¹äºæ›´å¤æ‚çš„åˆ†å¸ƒæƒ…å†µï¼ŒåŒºé—´æ›´å®½äº›ğŸ‘‡ï¼ŒæŠŠ$P$å˜æˆ$Q$æœ‰æ— ç©·å¤šç§ï¼Œ**ç©·ä¸¾æ‰€æœ‰çš„â€œmoving planâ€ä¸­average distance**_**æœ€å°çš„å€¼æ‰æ˜¯**_**Wasserstein distance**ï¼Œå‚è€ƒåšå®¢ï¼š[Wasserstein GAN and the Kantorovich-Rubinstein Duality - Vincent Herrmann](https://vincentherrmann.github.io/blog/wasserstein/)

![](https://s1.328888.xyz/2022/05/03/h4bzO.png)

ä½¿ç”¨Wasserstein distanceå¯ä»¥åæ˜ å‡ºè®­ç»ƒè¿‡ç¨‹ä¸­ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„è·ç¦»å˜åŒ–ï¼ˆä¼˜åŠ£ï¼‰ï¼Œè€ŒäºŒåˆ†ç±»å™¨æ— æ³•åšåˆ°ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå®ƒæè¿°äº†ä¸€ç§æ¸æ¸å˜åŒ–çš„è¶‹åŠ¿ï¼ˆè€Œéçªå˜ï¼‰ï¼Œè¿™ç§è¶‹åŠ¿ä½“ç°çš„å·®å¼‚èƒ½å¤Ÿè®©æˆ‘ä»¬å»trainæˆ‘ä»¬çš„generatorå»minimizeæˆ‘ä»¬å®šä¹‰çš„Wasserstein distance

### ==WGAN==

å®šä¹‰ï¼šå°±æ˜¯ç”¨_Wasserstein distance_å–ä»£_JS divergence_çš„**GAN**ï¼Œç”¨_Wasserstein distance_æ¥è¯„ä¼°$P\_G$å’Œ$P\_{data}$ä¹‹é—´çš„è·ç¦»ã€‚

$$
\underset{D \in 1-Lipschitz}{max}\{E_{y\sim P_{data}}[D(y)]-E_{y\sim P_{G}}[D(y)]\}
$$

_Wasserstein distance_å¦‚ä½•è®¡ç®—â€”â€”å»è§£ç­”ä¸Šï¼ˆ3ï¼‰è¿™ä¸ªå¼å­ï¼Œè§£å‡ºæ¥çš„å€¼å°±æ˜¯distanceçš„æ•°å€¼è§£ï¼Œæ³¨æ„åˆ°ï¼šè¿™é‡Œçš„$y$æŒ‡çš„æ˜¯networkçš„è¾“å‡º

$D \in 1 - Lipschitz$ ï¼šè¡¨æ˜$D$å¿…é¡»æ˜¯ä¸€ä¸ªè¶³å¤Ÿå¹³æ»‘çš„functionï¼›å¦‚æœæ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œå…³äº$D$çš„è®­ç»ƒæ°¸è¿œä¸ä¼šæ”¶æ•›ï¼Œè¿™äº›maximumå°±ä¼šè¶‹äºæ— ç©·å¤§ã€‚æ–‡ç« ï¼šhttps://arxiv.org/abs/1701.07875

![](https://s1.328888.xyz/2022/05/03/h4F1q.png)

æ€ä¹ˆå»çœŸçš„è§£ï¼ˆ3ï¼‰è¿™ä¸ªå¼å­ï¼Ÿåˆæ€æ ·å»ä¿è¯$D$çš„å¹³æ»‘æ€§ï¼Ÿ

åœ¨æœ€åˆçš„è§£ç­”ä¸­ç ”ç©¶è€…åšäº†ç²—ç³™çš„å¤„ç†ğŸ‘‡ï¼Œè¿™ä¸ªå®é™…ä¸Šæ²¡æœ‰è§£è¿™ä¸ªå¼å­ï¼Œè€Œæ˜¯åšäº†ç²—çº¿æ¡çš„è¿‘ä¼¼è®¡ç®—ï¼Œå½“ç„¶ç¼ºé™·å¾ˆå¤§ã€‚

![](https://s1.328888.xyz/2022/05/03/h4ZeP.png)

åæ¥å¦å¤–ä¸€ä¸ªæƒ³æ³•æ˜¯ï¼š$Improve \space WGAN \rightarrow Gradient \space Penalty$ï¼Œæ¥è‡ª[ä¸€ç¯‡æ–‡ç« ](https://arxiv.org/abs/1704.00028)

![](https://s1.328888.xyz/2022/05/03/h4jDm.png)

ä»¥åŠ[Spectral Normalization for Generative Adversarial Networks](https://arxiv.org/abs/1802.05957)æ‰€ä»‹ç»çš„**Spectral Normalization** $ \Rightarrow$ Keep gradient norm smaller than 1 everywhereï¼ˆä¸ºäº†å¾—åˆ°æ›´å¥½çš„GANï¼Œåº”å½“å‚è€ƒä¸‹è¿™ç¯‡æ–‡ç« ï¼‰

> **è¯¾åé—®é¢˜è§£ç­”**
>
> generatorå’Œdiscriminatoré€šå¸¸éƒ½ä¸ä¼šä¸€ç›´è¿­ä»£åˆ°æ”¶æ•›ï¼Œåªè¿­ä»£å‡ æ¬¡ï¼Œå°±äº¤æ¢ç»™å¦å¤–ä¸€ä¸ªç”Ÿæˆå™¨ï¼ˆå› ä¸ºæ—¶é—´æˆæœ¬ï¼‰ï¼›æ‰€ä»¥åœ¨å®é™…åšçš„æ—¶å€™ï¼Œè®¸å¤šå‚æ•°å°±ä¼šâ€œç»§æ‰¿â€å‰ä¸€ä¸ªgeneratoræˆ–æ˜¯å¯¹åº”çš„discriminatorï¼ˆè¿™ä¸ªå°±æ˜¯ç†è®ºå’Œå®åšçš„åŒºåˆ«ï¼‰ï¼Œè€Œä¸ä¼šé‡å¤´å¼€å§‹è®­ç»ƒ

WGANæœ‰å¾ˆå¤šç§ä¸åŒçš„åšæ³•ï¼Œå…¶ä¸­æ•ˆæœæœ€å¥½çš„å°±æ˜¯ä¸Šè¿°æåˆ°çš„**Spectral Normalizationï¼ˆSNGANï¼‰**ã€‚ä½†æ˜¯å³ä½¿æœ‰WGANï¼ŒGANä¾ç„¶å¾ˆéš¾trainèµ·æ¥ï¼ŒGANæ˜¯ä»¥ä¸å¥½trainè€Œé—»åçš„ã€‚æ‰€ä»¥æˆ‘ä»¬äº¦å¯ä»¥è¯´GAN is still challengingâ€¦

![](https://s1.328888.xyz/2022/05/03/h4v3A.png)

Generatorå’ŒDiscriminatorå¿…é¡»â€œæ£‹é€¢å¯¹æ‰‹â€ï¼Œç›¸äº’â€œå¯¹æŠ—â€ï¼Œç›¸äº’ä¿ƒè¿›ã€‚å¦‚æœå…¶ä¸­ä¸€æ–¹æ²¡æœ‰trainå¥½ï¼Œå¦ä¸€æ–¹ä¹Ÿä¼šå‡ºç°åœæ»â€”â€”åŒæˆå‘˜çš„æ­£åé¦ˆã€‚

ä¸ºäº†èƒ½å¤Ÿtrainèµ·æ¥ï¼Œä¹Ÿæ˜¯éœ€è¦è°ƒè¶…å‚æ•°ï¼ˆhyper parameterï¼‰çš„ã€‚

#### ç½‘ç»œä¸Šæ›´å¤šçš„Tips

* [Tips from Soumith](https://github.com/soumith/ganhacks)
* [Tips in DCGAN: Guideline for network architecture design for image generation](https://arxiv.org/abs/1511.06434)
* [Improved techniques for training GANs](https://arxiv.org/abs/1606.03498)
* [Tips from BigGAN](https://arxiv.org/abs/1809.11096)

***

## GAN for Sequence Generation

> è¯¾ç¨‹å‰é¢éƒ¨åˆ†ä½¿ç”¨GANçš„æ ·ä¾‹æ˜¯ç”Ÿæˆï¼ˆäºŒæ¬¡å…ƒï¼‰å›¾åƒï¼Œè€Œè®­ç»ƒGANæœ€éš¾çš„åœ°æ–¹æ˜¯è¦æ‹¿GANæ¥ç”Ÿæˆæ–‡å­—ã€‚

![](https://s1.328888.xyz/2022/05/03/h46BS.png)

åŒæ ·æ˜¯Generatorè¦å»ç”Ÿæˆâ€œä»¥å‡ä¹±çœŸâ€çš„æ–‡å­—å¯ä»¥foolåˆ°Discriminatorçš„ç¨‹åº¦ï¼Œä»¥è°ƒæ•´Generatorï¼ˆDecoderï¼‰çš„å‚æ•°ã€‚

è€Œéš¾ç‚¹åœ¨äºå¦‚æœè¦ç”¨æ¢¯åº¦ä¸‹é™æ³•å»trainè¿™ä¸ªDecoderï¼ˆç›®æ ‡ï¼šè®©Discriminatoråˆ†æ•°è¶Šå¤§è¶Šå¥½ï¼‰ï¼Œå®æˆ˜ä¸­ä¼šå‘ç°æˆ‘ä»¬æ ¹æœ¬åšä¸åˆ°â€”â€”åŸå› åœ¨äºDecoderæŸä¸ªå‚æ•°çš„å°å°å˜åŒ–ï¼ˆåå¾®åˆ†ï¼‰ï¼Œåœ¨attentionæœºåˆ¶ä¸‹ï¼Œåˆ†æ•°æœ€å¤§çš„tokenï¼ˆtokenå–å†³äºä»»åŠ¡å’Œæˆ‘ä»¬çš„è®¾è®¡ï¼‰æ²¡æœ‰æ”¹å˜ï¼Œä»¥è‡³äºDiscriminatorçš„åˆ†æ•°ä¹Ÿæ²¡æœ‰æ”¹å˜ã€‚

attentionæœºåˆ¶ä¸‹çš„**max or sample**ä¸‹ï¼Œå°½ç®¡æ•°å€¼æœ‰åœ¨å˜åŒ–è€Œå–å‡ºæ¥çš„tokenï¼ˆå¯èƒ½æ˜¯characteræˆ–å­—ç¬¦ï¼‰å¾€å¾€ä¸å˜ï¼Œå¯¼è‡´gradient decentå‡ è¿‘å¤±æ•ˆï¼›è€ŒCNNä¸­çš„**max Poolingå±‚**ä¸‹ï¼Œæ•°å€¼æ˜¯ä¸€ç›´éšç€å˜åŒ–çš„ï¼Œæ•…gradient decentæœ‰æ•ˆã€‚

**é‡åˆ°ä¸èƒ½ç”¨gradient decentæ¥trainçš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±è¦å½“ä½œReinforcement Learningï¼ˆRLï¼‰çš„é—®é¢˜æ¥ç¡¬åšï¼**

æ°å¥½åœ°ï¼ŒRLéå¸¸éš¾trainï¼ŒGANéå¸¸éš¾trainï¼Œå¯¼è‡´GANåšæ–‡å­—ç”Ÿæˆç›¸å½“å›°éš¾ã€‚å¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡æœ‰äººèƒ½æŠŠGeneratorè®­ç»ƒèµ·æ¥ï¼›åœ¨é¢å¯¹è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬å…ˆåš**Pretrain**ï¼ˆé¢„è®­ç»ƒï¼‰â€”â€”ä¹‹åä¼šè®²åˆ°ã€‚

è¿‡å»æ²¡æœ‰æ­£å¸¸çš„æ–¹æ³•æ¥trainè¿™æ ·å­çš„GANï¼Œç›´åˆ°æå‡º[Scratch GAN](https://arxiv.org/abs/1905.09922)ï¼Œfrom Scratchå°±æ˜¯ä¸éœ€è¦pretrainçš„æ„æ€ã€‚æ‰€ä»¥å®ƒç”¨äº†ä»€ä¹ˆé­”æ³•ï¼Ÿâ€”â€”çˆ†è°ƒäº†è¶…å‚æ•°ï¼Œä»¥åŠå„ç§tipsï¼ˆæ¥è‡ªgoogleçš„æ–‡ç« enmmmï¼‰\[enough hyperparameter-tuning and tips]

![](https://s1.328888.xyz/2022/05/03/h4N8R.png)

***

## More Generative Models

> GANæ˜¯æœ€å¹¿æ³›ä½¿ç”¨è€Œä¸”performanceä¹Ÿå¾ˆå¥½ï¼›ä»¥ä¸‹çš„å¯ä»¥è‡ªè¡Œäº†è§£ï¼Œtrainçš„éš¾åº¦ä¹Ÿä¸é‘å¤šè®©ã€‚

* Variational Autoencoderï¼ˆVAEï¼‰
* FLOW-based Model

### ç”¨supervised learningæ¥åšå›¾åƒç”Ÿæˆ

æˆ‘ä»¬æœ‰ä¸€å †å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡ç”¨ä¸€ä¸ªvectoræ¥è¡¨ç¤ºï¼Œç„¶åâ€œç¡¬trainä¸€å‘â€ï¼Œå½“ç„¶éœ€è¦ç”¨åˆ°ç‰¹æ®Šçš„æ–¹æ³•æ¥å®‰æ’è¿™äº›è®­ç»ƒçš„vectorsã€‚å¯å‚è€ƒçš„ç ”ç©¶ï¼š[Generative Latent Optimization (GLO)](https://arxiv.org/abs/1707.05776)ã€[Gradient Origin Networks](https://arxiv.org/abs/2007.02798)

![](https://s1.328888.xyz/2022/05/03/h4SRi.png)

***

## Evaluation of Generation

> ç”Ÿæˆå™¨æ•ˆèƒ½è¯„ä¼°ä¸æ¡ä»¶å¼ç”Ÿæˆã€‚

### Quality of Image

* æ—©æœŸï¼šæ‰¾äººæ¥çœ‹â€”â€”human evaluation is expensive(è€Œä¸”ä¸å®¢è§‚ï¼Œä¸ç¨³å®š)
*   ä¸€ä¸ªç±»åˆ«è·‘ä¸€ä¸ªå›¾åƒçš„åˆ†ç±»ç³»ç»ŸğŸ‘‡

    ![](https://s1.328888.xyz/2022/05/03/h4ovv.png)

    æ£€éªŒç”Ÿæˆå‡ºæ¥å›¾åƒæ˜¯å¦åˆç†ï¼Œç”¨æœºå™¨æ¥éªŒè¯æœºå™¨ã€‚ä¸è¿‡å…‰ç”¨è¿™ä¸ªåšæ³•æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç”Ÿæˆçš„ç»“æœçš„**diversity**è¿›è¡Œè€ƒé‡ã€‚å¦‚æœåªç”¨è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬ä¼šè¢«ä¸€ä¸ªç§°ä½œ**Mode Collapse**çš„ä¸œè¥¿foolè¿‡å»ã€‚

    > Mode Collapseï¼ˆæ¨¡å‹åç¼©ï¼‰ï¼šç”Ÿæˆæ•°é‡å·¨å¤§åï¼Œäº§ç”Ÿæ•ˆæœå•ä¸€
    >
    > ![](https://s1.328888.xyz/2022/05/03/h4EL0.png)
    >
    > æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºdiscriminatorçš„ä¸€ä¸ªç›²ç‚¹ï¼Œgeneratorç¡¬æ‰“ä¸€å‘ï¼Œå°±æ··è¿‡å»äº†ã€‚ç›®å‰æœ‰æ•ˆå½»åº•çš„è§£å†³æ–¹æ³•è¿˜æ²¡æœ‰ï¼Œå³ä½¿æ˜¯å¼ºå¦‚Googleçˆ†æœå‚æ•°ï¼Œä¹Ÿä»…ä»…æ˜¯åœ¨å¯Ÿè§‰åˆ°mode collapseåå°±åœæ­¢trainï¼Œæ”¶æ‰modelã€‚

    è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ç§°ä¹‹ä¸º**Mode Dropping**ï¼Œä¸å¤ªå®¹æ˜“è¢«ä¾¦æµ‹å‡ºæ¥ã€‚

    > Mode Droppingï¼š
    >
    > ![](https://s1.328888.xyz/2022/05/03/h4PCJ.png)
    >
    > ä¾ç„¶æ˜¯ç”ŸæˆdataèŒƒå›´å¤ªçª„ï¼Œå‡ºç°äº†äº›æ¨¡å¼ç±»ä¼¼çš„ç°è±¡ã€‚
    >
    > è­¬å¦‚![](https://s1.328888.xyz/2022/05/03/h4x1F.png)ï¼ˆè‚¤è‰²å·®å¼‚ï¼ŒåŒä¸€ä¸ªiterationè‚¤è‰²ç›¸ä¼¼ï¼‰
    >
    > è¿™ä¸ªé—®é¢˜æ²¡æœ‰è·å¾—æœ¬è´¨æ€§è§£å†³ã€‚

    è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦Image Classifierï¼ŒéªŒè¯è¿‡ç¨‹ï¼šæŠŠç”Ÿæˆæ‰€æœ‰å›¾ç‰‡ä¸¢å°½image Classifyé‡Œé¢ï¼Œå¾—åˆ°å„ä¸ªå›¾ç‰‡çš„distributionï¼ˆåˆ†å¸ƒï¼‰ï¼ŒæŠŠæ‰€æœ‰çš„distributionå¹³å‡èµ·æ¥ï¼Œçœ‹çœ‹å¹³å‡çš„distributionæ˜¯å¦é›†ä¸­èµ·æ¥ï¼Œè‹¥æ˜¯ï¼Œè¯´æ˜å¤šæ ·æ€§ä¸è¶³ï¼Œæ¯å¼ å›¾ç‰‡éƒ½å¾ˆç±»ä¼¼ã€‚

    ![](https://s1.328888.xyz/2022/05/03/hHUuW.png)

    â€‹

    ![image-20211006114718306](https://s1.328888.xyz/2022/05/03/hHedy.png)

    â€‹
*   Diversityå’Œqualityå¥½åƒæ˜¯æœ‰å¸¦ç‚¹äº’æ–¥çš„ï¼›åˆ†å¸ƒè¶Šé›†ä¸­ï¼Œqualityè¶Šå¥½ï¼›åˆ†å¸ƒè¶Šå¹³å¦ï¼Œdiversityè¶Šå¥½ã€‚ä½†æ˜¯ä¸¤è€…èŒƒå›´ä¸ä¸€æ ·ï¼Œqualityçœ‹ä¸€å¼ å›¾ç‰‡ï¼Œdiversityçœ‹ç”Ÿæˆçš„ä¸€æ‰¹å›¾ç‰‡ã€‚

    è¿‡å»æœ‰ä¸€ä¸ªå¸¸è¢«ä½¿ç”¨çš„æŒ‡æ ‡ï¼š**Inception Scoreï¼ˆISï¼‰**â€”â€”Good quality, large diversity $\rightarrow$ Large **IS**ã€‚ä½¿ç”¨æ–¹æ³•ï¼šç”¨_Inception Network_é‡ä¸€ä¸‹qualityï¼Œå¦‚æœqualityé«˜ï¼Œdiversityå¤§ï¼Œé‚£ISå°±é«˜ã€‚ISä¸é€‚ç”¨äºè¡¡é‡diversityã€‚ï¼ˆæ¯å¼ äºŒæ¬¡å…ƒäººç‰©éƒ½æ˜¯ä¸€ä¸ªâ€œäººè„¸â€ï¼‰

### FrÃ©chet Inception Distance (FID)

> æ¥è‡ªhttps://arxiv.org/pdf/1706.08500.pdf

åœ¨æŠŠä¸€å¼ å›¾åƒä¸¢è¿›CNNçš„ç½‘ç»œçš„pipelineé‡Œé¢ï¼Œå¯ä»¥åœ¨$softmax$ä¹‹å‰æˆªä¸‹æ¥ï¼ˆæœ€åä¸€å±‚Hidden Layerçš„è¾“å‡ºä»£è¡¨å›¾ç‰‡ï¼‰ï¼Œç”»å‡ºæ¥å‡è®¾ï¼ˆåœ¨äºŒç»´å¹³é¢ï¼‰é•¿è¿™å‰¯æ ·å­

![](https://s1.328888.xyz/2022/05/03/hHu3k.png)

æŠŠåˆ†å¸ƒå½“ä½œæ˜¯é«˜æ–¯åˆ†å¸ƒï¼ˆGaussians Distributionï¼‰ï¼Œä½†æ˜¯å¦‚æœè¦å¾—åˆ°å‡†ç¡®çš„åˆ†å¸ƒâ€”â€”éœ€è¦å¤§é‡çš„samplesï¼ˆæ ·æœ¬ï¼‰ä¹Ÿéœ€è¦ä¸€ç‚¹è¿ç®—é‡

åœ¨ä½œä¸šé‡Œé¢ï¼Œæˆ‘ä»¬ä¸ä»…çœ‹**FID**ï¼ˆsmaller is betterï¼‰ï¼Œè€Œä¸”è¿˜è¦çœ‹äºŒæ¬¡å…ƒäººè„¸ä¾¦æµ‹å‡ºæ¥çš„æ•°ç›®ï¼ˆå½“ç„¶è¶Šå¤§è¶Šå¥½ï¼‰ã€ä¸¤ä¸ªæŒ‡æ ‡ã€‘

> [Are GANs Created Equal? A Large-Scale Study](https://arxiv.org/abs/1711.10337)
>
> Googleçˆ†åšï¼Œå„å¼å„æ ·çš„GANğŸ‘‡
>
> ![](https://s1.328888.xyz/2022/05/03/hHyEd.png)

æŸäº›ç§ç±»çš„GANåœ¨æŸäº›æ¶æ„çš„networkä¸Šè¡¨ç°è¾ƒå¥½ã€‚

ä¹Ÿä¼šæœ‰ä¸€ç§ç°è±¡ï¼ˆé—®é¢˜ï¼‰ï¼ŒGANç”Ÿæˆçš„å›¾ç‰‡å’Œè®­ç»ƒçš„å›¾ç‰‡å‡ ä¹ä¸€è‡´ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬çš„ç›®çš„ï¼Œæ‰€ä»¥éœ€è¦ä¾¦æµ‹ä¸‹real dataå’ŒGenerated dataçš„ç›¸ä¼¼åº¦ï¼ˆå¤åˆ¶ã€ç¿»è½¬ã€æ”¾å¤§ï¼‰https://arxiv.org/pdf/1511.01844.pdf

åœ¨[Pros and cons of GAN evaluation measures](https://arxiv.org/abs/1802.03446)ä¸­ç»™å‡ºäº†å…³äºGANçš„è®¸å¤šè¯„ä»·æŒ‡æ ‡ã€‚

***

## Conditional Generation

> ä¹‹å‰æˆ‘ä»¬ä»¥ç”ŸæˆäºŒæ¬¡å…ƒå¤´åƒä¸ºä¾‹çš„GANç”¨çš„æ˜¯unconditional generationã€‚

![](https://s1.328888.xyz/2022/05/03/hHgAQ.png)

*   å¯ä»¥åš_**Text-to-image**_ï¼šä»æ–‡æœ¬ä¸­ç”Ÿæˆå›¾ç‰‡ã€‚è¿™æ˜¯ä¸€ä¸ªsupervised learningé—®é¢˜ï¼Œåœ¨è®­ç»ƒé›†ä¸Šï¼Œæˆ‘ä»¬éœ€è¦æœé›†ä¸€äº›å›¾ç‰‡ç„¶ååŠ ä¸Šä¸€äº›labelï¼ˆç‰¹å¾ï¼Œæ–‡å­—çš„æè¿°ï¼‰

    è¾“å…¥çš„$x$åº”è¯¥æ˜¯ä¸€æ®µæ–‡æœ¬ï¼ˆç‰¹å¾æè¿°ï¼‰ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œå¯ä»¥ç”¨transformer

    è¾“å…¥çš„$z$å°±æ˜¯æ­£æ€åˆ†å¸ƒï¼ˆNormal Distributionï¼‰

### Conditional GAN

ä»¥ä¸‹ç»™å‡ºçš„æ–¹æ³•æ˜¯é”™è¯¯çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿè¿™ä¸ªæ¶æ„å®Œå…¨ç±»ä¼¼äºunconditional GANï¼Œäº‹å®ä¸Šåœ¨è®­ç»ƒå½“ä¸­ï¼Œåªè¦generatoräº§ç”Ÿå›¾åƒå¯ä»¥foolæ‰discriminatorå°±å¥½äº†ï¼Œé‚£ä¹ˆè¾“å…¥çš„$x$çš„ä½œç”¨å®Œå…¨æ²¡æœ‰ä½“ç°å‡ºæ¥ã€‚æ‰€ä»¥è¯´ï¼Œè¿™ä¸ªæ¶æ„æ˜¯é”™è¯¯çš„ï¼ˆä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼‰ã€‚

![](https://s1.328888.xyz/2022/05/03/hH9R3.png)

ä»¥ä¸‹ç»™å‡ºæ­£ç¡®çš„è®¾è®¡ğŸ‘‡ï¼Œæ¥è‡ªhttps://arxiv.org/abs/1605.05396

ä¸ºäº†åœ¨è®­ç»ƒä¸­å¾—åˆ°é«˜åˆ†ï¼Œä¸ä»…èƒ½ç”Ÿäº§å‡ºå›¾åƒå¯ä»¥foolæ‰discriminatorï¼Œè€Œä¸”æ–‡å­—labelå’Œå›¾åƒéœ€è¦åŒ¹é…ä¸Šã€‚å› æ­¤æˆ‘ä»¬**è®­ç»ƒæ‰€éœ€è¦çš„æ•°æ®å¿…é¡»æ˜¯æˆå¯¹å‡ºç°çš„**

![](https://s1.328888.xyz/2022/05/03/hHJ64.png)

ä¸è¿‡ï¼Œä»…ä»…ä»¥ä¸Šé¢è¿™ç§positive Sampleæˆ–æ˜¯negative sampleå¾€å¾€æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨è®­ç»ƒé›†ä¸Šå¢åŠ å·²ç»è¿™æ ·çš„æ•°æ®å¯¹ï¼ˆå·²ç»äº§ç”Ÿå¥½çš„æ•°æ®å¯¹ï¼Œä½†å’Œæ–‡å­—labelä¸ç¬¦ï¼‰ã€å·¦ä¸‹ã€‘ï¼Œç±»ä¼¼æ˜¯**penalty Itemï¼ˆæƒ©ç½šå› å­ï¼‰**

*   çœ‹ä¸€å¼ å›¾ç‰‡ç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œ**Image translation** or **pix2pix**

    > æ¥è‡ªhttps://arxiv.org/abs/1611.07004
    >
    > ![](https://s1.328888.xyz/2022/05/03/hHXLB.png)

    å…·ä½“çš„å®ç°æ–¹æ³•ï¼š

    * å½“ç„¶å¯ä»¥ç”¨supervised learningï¼Œä½†æ˜¯å‰äººå®è·µè¯æ˜å¯èƒ½æ•ˆæœä¸å¤ªå¥½
    *   ç”¨GANæ¥trainï¼ˆç”±äºGANåˆ›é€ åŠ›è¿‡äºä¸°å¯Œäº†ï¼ŒåŠ supervised learningã€é™åˆ¶ã€‘å¯èƒ½ä¼šæ›´å¥½ï¼‰

        ![](https://s1.328888.xyz/2022/05/03/hHfCT.png)
*   ä¸€æ®µå£°éŸ³ç”Ÿæˆä¸€å¼ å›¾ç‰‡ğŸ‘‡

    > æ¥è‡ªhttps://arxiv.org/abs/1808.04108

    ![](https://s1.328888.xyz/2022/05/03/hHib2.png)

    æœ‰æ„æ€çš„æ˜¯ï¼Œå½“å£°éŸ³è¶Šæ¥è¶Šå¤§ï¼Œç”Ÿæˆçš„å›¾ç‰‡ä¼¼ä¹ä¹Ÿä¼šå¯¹å…¶åšå‡ºååº”ï¼Œä»¿ä½›æœºå™¨çœŸçš„å­¦ä¹ åˆ°äº†å£°éŸ³çš„æ„å‘³â€¦
*   ç”Ÿæˆä¼šåŠ¨çš„å›¾åƒï¼Œè­¬å¦‚**Talking Head Generation**

    > æ¥è‡ªhttps://arxiv.org/abs/1905.08233

***

## Learning from Unpaired Data

> æˆ‘ä»¬å¯èƒ½è¦è®­ç»ƒè¿™ä¸€ç§ç½‘ç»œï¼Œè®­ç»ƒéœ€è¦çš„æ•°æ®å¾€å¾€æˆå¯¹å‡ºç°$(x,y)$ï¼Œä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬çš„ç¡®æœ‰ä¸€å †$x$ï¼Œä¹Ÿæœ‰ä¸€å †$y$ï¼Œä½†æ˜¯ä¸¤è€…å¹¶ä¸å„ä¸ªåŒ¹é…æˆå¯¹ï¼ˆunpairedï¼‰
>
> ![](https://s1.328888.xyz/2022/05/03/hH8d7.png)
>
> æˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•åœ¨è¿™ç§æƒ…å†µä¸‹trainå‘¢ï¼Ÿï¼ˆwithout labelsï¼‰
>
> é£æ ¼è¿ç§»ä»»åŠ¡ï¼šæ— ç›‘ç£å­¦ä¹ çš„å…¸å‹ï¼Œæ²¡æœ‰ä»»ä½•æˆå¯¹çš„æ•°æ®ï¼ˆèµ„æ–™ï¼‰

ä¹‹å‰æˆ‘ä»¬è®²è¿‡unconditional GANçš„æµç¨‹ï¼Œå¦‚ä¸‹

![](https://s1.328888.xyz/2022/05/03/hrqRT.png)

å°†ä¸Šè¿°æµç¨‹ä¸­çš„$z$å’Œ$y$æ›¿æ¢æˆ$Domain \space x$å›¾ç‰‡çš„åˆ†å¸ƒå’Œ$Domain \space y$çš„å›¾ç‰‡çš„åˆ†å¸ƒğŸ‘‡

![](https://s1.328888.xyz/2022/05/03/hH2uM.png)

è¿™é‡ŒæŒ‡å‡ºGANå¯ä»¥ç”¨æ¥å¯»æ‰¾åŸŸçš„æ˜ å°„å…³ç³»ï¼š$x \rightarrow y$ï¼›å…¶ä¸­$x$ï¼Œ$y$ä¸ºä¸€å¯¹ï¼ˆpairï¼‰æ•°æ®ï¼Œè¿™ç§æ–¹æ³•ç§°ä¹‹ä¸º**Unsupervised Conditional Generation**

å¯¹åº”åœ¨æ•°æ®ä¸ºå›¾åƒä¸Šäººç‰©é€šå¸¸æ˜¯å›¾åƒé£æ ¼è¿ç§»ä»»åŠ¡ï¼Œè­¬å¦‚çœŸäººå¤´åƒ-->åŠ¨æ¼«å¤´åƒ

### Cycle GAN

> Cycle GANï¼Œå³**å¾ªç¯ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ**ï¼Œå‡ºè‡ªå‘è¡¨äº ICCV17 çš„è®ºæ–‡ã€ŠUnpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networksã€‹ï¼Œå’Œå®ƒçš„å…„é•¿Pix2Pixï¼ˆå‡ä¸ºæœ±å¤§ç¥ä½œå“ï¼‰ä¸€æ ·ï¼Œç”¨äºå›¾åƒé£æ ¼è¿ç§»ä»»åŠ¡ã€‚

åœ¨åŸæ¥çš„GANé‡Œé¢ï¼šå¯ä»¥è¢«sampleçš„ä¸€ä¸ªdistributionï¼ˆä¸ä¸€å®šæ˜¯é«˜æ–¯åˆ†å¸ƒï¼‰å½“ä½œ$x$ä¸¢å°½generatorï¼Œåœ¨è¿™ä¸ªä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬è®¤ä¸ºå¯ä»¥ä¸¢å°½ä¸€å¼ éœ€è¦è¢«é£æ ¼è¿ç§»çš„çœŸäººäººè„¸å›¾åƒï¼Œå½“ç„¶è¿˜è¦è®¾è®¡å‡ ä¸ªdiscriminatorï¼Œçœ‹åˆ°æ˜¯$Y \space domain$çš„å›¾å°±ç»™é«˜åˆ†ï¼Œä¸æ˜¯å°±ç»™ä½åˆ†ã€‚

ä½†æ˜¯ä¸€èˆ¬çš„GANçš„åšæ³•æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œå¯èƒ½è¾“å‡ºä¼šäº§ç”ŸäºŒæ¬¡å…ƒå¤´åƒï¼ˆdiscriminatorä¼šç»™é«˜åˆ†ï¼‰ä½†æ˜¯å’Œè¾“å…¥æ¯«æ— å…³ç³»ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚

![](https://s1.328888.xyz/2022/05/03/hHAKX.png)

Cycle GANå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªå·§å¦™çš„æƒ³æ³•ã€‚

å®ƒè¦æ±‚è®­ç»ƒä¸¤ä¸ªGeneratorï¼šç¬¬ä¸€ä¸ª$G\_{x\rightarrow y}$æ˜¯æŠŠä¸€å¼ $X \space domain$çš„å›¾è½¬æ¢æˆä¸€å¼ $Y \space domain$çš„å›¾ï¼›ç¬¬äºŒä¸ª$G\_{y\rightarrow x}$çš„ä½œç”¨æ˜¯æŠŠ$Y \space domain$ä¸Šçš„å›¾**è¿˜åŸ**å›$X \space domain$ä¸Šçš„å›¾ã€‚ç»è¿‡ä¸¤æ¬¡è½¬æ¢åï¼Œè¾“å…¥å’Œè¾“å‡ºè¶Šæ¥è¿‘è¶Šå¥½ï¼ˆä¸¤å¼ å›¾åƒæµå½¢å‘é‡çš„è·ç¦»æ¥è¡¡é‡ï¼‰

![](https://s1.328888.xyz/2022/05/03/hHhEZ.png)

ä¸¤ä¸ªdiscriminatorï¼š$D\_x$è¦çœ‹æƒ³ä¸æƒ³çœŸå®çš„äººè„¸

ç›¸è¾ƒä¸€èˆ¬çš„GANçš„ä¼˜ç¼ºç‚¹ï¼š

* ä¸ºäº†è€ƒè™‘åˆ°ç¬¬äºŒæ¬¡çš„è¿˜åŸä»»åŠ¡çš„å®Œæˆâ€”â€”ç¬¬ä¸€æ¬¡è½¬æ¢åˆ°äºŒæ¬¡å…ƒå¤´åƒä¸ä¼šä¹±åšäº†(\*^\_^\*)ï¼Œè€Œä¼šè€ƒè™‘åˆ°è¾“å…¥çœŸäººå¤´åƒ
* è¿™ä¸ªäºŒæ¬¡å…ƒå›¾åƒè¾“å‡ºï¼ˆä»»åŠ¡çš„æœ€ç»ˆç›®æ ‡è¾“å‡ºï¼‰å¿…é¡»**å…³è”**inputï¼Œä»è€Œå³ä½¿æ²¡æœ‰labelsä¹Ÿæœ‰äº†reconstructçš„å¯èƒ½
* æ— æ³•ä¿è¯è¾“å…¥å’Œè¾“å‡ºä¼šçœŸçš„å¾ˆåƒï¼Œå› ä¸ºæœºå™¨å¯èƒ½ä¼šå­¦ä¹ åˆ°ä¸€äº›å¥‡æ€ªçš„modeï¼ˆå®ƒå”¯ä¸€çš„é™åˆ¶ä¸è¿‡å°±æ˜¯ç¬¬äºŒæ¬¡è¿˜åŸåº¦è¾ƒé«˜å°±è¡Œï¼‰
* äº‹å®ä¸Šï¼ŒGANç¡¬åšä¹Ÿèƒ½åšï¼Œby defaultä¼šè¾“å‡ºå¾ˆåƒçš„ä¸œè¥¿

### å…¶ä»–GANä»¬

> ç±»ä¼¼äºCycle GANï¼Œç”¨æ¥å®Œæˆé£æ ¼è¿ç§»ä»»åŠ¡

* [**Disco GAN**](https://arxiv.org/abs/1703.05192)
* [**Dual GAN**](https://arxiv.org/abs/1704.02510)
* [**Cycle GAN**](https://arxiv.org/abs/1703.10593)

ä»¥ä¸Šå‡ ä¸ªéƒ½æ˜¯ä¸åŒçš„å›¢é˜Ÿå‡ ä¹åœ¨ä¸€æ ·çš„æ—¶é—´ï¼ˆ17å¹´ï¼‰æå‡ºçš„å‡ ä¹ä¸€æ ·çš„ideaæ¥å®Œæˆè¿™ä¸ªä»»åŠ¡

å¦å¤–æœ‰ä¸€ç§GANå¯ä»¥åœ¨å¤šç§é£æ ¼é—´åšè½¬æ¢ï¼š

*   [Star GAN](https://arxiv.org/abs/1711.09020)

    ![](https://s1.328888.xyz/2022/05/03/hHHAC.png)

***

### å…³äºæ–‡å­—é£æ ¼è¿ç§»ä»»åŠ¡ï¼ˆText Style Transferï¼‰

> seq2seqä»»åŠ¡ï¼Œå…·ä½“å®ç°å’ŒCycle GANå‡ ä¹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„

* é¦–å…ˆæ”¶é›†ä¸€äº›sequenceè®­ç»ƒèµ„æ–™
* ç±»ä¼¼Cycle GANçš„åšæ³•![](https://s1.328888.xyz/2022/05/03/hHqYg.png)

> å…¶ä¸­æœ‰å‡ ä¸ªé—®é¢˜ï¼š
>
> 1ã€æ€ä¹ˆè¡¡é‡ä¸¤ä¸ªå¥å­æˆ–sequenceçš„ç›¸ä¼¼åº¦ï¼Ÿâ€”â€”ä½™å¼¦ç›¸ä¼¼åº¦
>
> 2ã€å…³äºå­—ç¬¦çš„ä»»åŠ¡ç”¨Discriminatorä¼šç”¨é—®é¢˜ï¼ˆä¹‹å‰æåˆ°è¿‡ï¼‰ï¼Œæ€ä¹ˆåŠï¼Ÿâ€”â€”RLç¡¬åš

ä¸€äº›æœ‰è¶£çš„å·¥ä½œï¼š

* Ducument $\rightarrow$ summaryï¼šUnsupervised Abstractive Summarizationï¼ˆhttps://arxiv.org/abs/1810.02851ï¼‰
* Language 1 $\rightarrow$ Lauguage 2ï¼šUnsupervised Translationï¼ˆhttps://arxiv.org/abs/1710.04087ã€https://arxiv.org/abs/1710.11041ï¼‰
* Audio $\rightarrow$ Textï¼šUnsupervised ASRï¼ˆhttps://arxiv.org/abs/1804.00316ã€https://arxiv.org/abs/1812.09323ã€https://arxiv.org/abs/1904.04100ï¼‰

***

GANå®Œç»“æ’’èŠ±_â˜…,Â°_:.â˜†(ï¿£â–½ï¿£)/$:_.Â°â˜…_ ã€‚
